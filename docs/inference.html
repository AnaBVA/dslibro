<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="models.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>1</b> Inferencia estadística</a><ul>
<li class="chapter" data-level="1.1" data-path="inference.html"><a href="inference.html#encuestas"><i class="fa fa-check"></i><b>1.1</b> Encuestas</a><ul>
<li class="chapter" data-level="1.1.1" data-path="inference.html"><a href="inference.html#el-modelo-de-muestreo-para-encuestas"><i class="fa fa-check"></i><b>1.1.1</b> El modelo de muestreo para encuestas</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="inference.html"><a href="inference.html#poblaciones-muestras-parametros-y-estimaciones"><i class="fa fa-check"></i><b>1.2</b> Poblaciones, muestras, parámetros y estimaciones</a><ul>
<li class="chapter" data-level="1.2.1" data-path="inference.html"><a href="inference.html#el-promedio-de-la-muestra"><i class="fa fa-check"></i><b>1.2.1</b> El promedio de la muestra</a></li>
<li class="chapter" data-level="1.2.2" data-path="inference.html"><a href="inference.html#parameters"><i class="fa fa-check"></i><b>1.2.2</b> Parameters</a></li>
<li class="chapter" data-level="1.2.3" data-path="inference.html"><a href="inference.html#polling-versus-forecasting"><i class="fa fa-check"></i><b>1.2.3</b> Polling versus forecasting</a></li>
<li class="chapter" data-level="1.2.4" data-path="inference.html"><a href="inference.html#properties-of-our-estimate-expected-value-and-standard-error"><i class="fa fa-check"></i><b>1.2.4</b> Properties of our estimate: expected value and standard error</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="inference.html"><a href="inference.html#ejercicios"><i class="fa fa-check"></i><b>1.3</b> Ejercicios</a></li>
<li class="chapter" data-level="1.4" data-path="inference.html"><a href="inference.html#clt"><i class="fa fa-check"></i><b>1.4</b> Teorema del límite central en la práctica</a><ul>
<li class="chapter" data-level="1.4.1" data-path="inference.html"><a href="inference.html#una-simulacion-de-monte-carlo"><i class="fa fa-check"></i><b>1.4.1</b> Una simulación de Monte Carlo</a></li>
<li class="chapter" data-level="1.4.2" data-path="inference.html"><a href="inference.html#la-propagacion"><i class="fa fa-check"></i><b>1.4.2</b> La propagación</a></li>
<li class="chapter" data-level="1.4.3" data-path="inference.html"><a href="inference.html#sesgo-por-que-no-realizar-una-encuesta-muy-grande"><i class="fa fa-check"></i><b>1.4.3</b> Sesgo: ¿por qué no realizar una encuesta muy grande?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="inference.html"><a href="inference.html#ejercicios-1"><i class="fa fa-check"></i><b>1.5</b> Ejercicios</a></li>
<li class="chapter" data-level="1.6" data-path="inference.html"><a href="inference.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>1.6</b> Intervalos de confianza</a><ul>
<li class="chapter" data-level="1.6.1" data-path="inference.html"><a href="inference.html#una-simulacion-de-monte-carlo-1"><i class="fa fa-check"></i><b>1.6.1</b> Una simulación de Monte Carlo</a></li>
<li class="chapter" data-level="1.6.2" data-path="inference.html"><a href="inference.html#el-idioma-correcto"><i class="fa fa-check"></i><b>1.6.2</b> El idioma correcto</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="inference.html"><a href="inference.html#ejercicios-2"><i class="fa fa-check"></i><b>1.7</b> Ejercicios</a></li>
<li class="chapter" data-level="1.8" data-path="inference.html"><a href="inference.html#poder"><i class="fa fa-check"></i><b>1.8</b> Poder</a></li>
<li class="chapter" data-level="1.9" data-path="inference.html"><a href="inference.html#valores-p"><i class="fa fa-check"></i><b>1.9</b> valores p</a></li>
<li class="chapter" data-level="1.10" data-path="inference.html"><a href="inference.html#association-tests"><i class="fa fa-check"></i><b>1.10</b> Pruebas de asociación</a><ul>
<li class="chapter" data-level="1.10.1" data-path="inference.html"><a href="inference.html#lady-tasting-tea"><i class="fa fa-check"></i><b>1.10.1</b> Lady Tasting Tea</a></li>
<li class="chapter" data-level="1.10.2" data-path="inference.html"><a href="inference.html#tablas-de-dos-en-dos"><i class="fa fa-check"></i><b>1.10.2</b> Tablas de dos en dos</a></li>
<li class="chapter" data-level="1.10.3" data-path="inference.html"><a href="inference.html#prueba-de-chi-cuadrado"><i class="fa fa-check"></i><b>1.10.3</b> Prueba de chi-cuadrado</a></li>
<li class="chapter" data-level="1.10.4" data-path="inference.html"><a href="inference.html#odds-ratio"><i class="fa fa-check"></i><b>1.10.4</b> La razón de posibilidades</a></li>
<li class="chapter" data-level="1.10.5" data-path="inference.html"><a href="inference.html#intervalos-de-confianza-para-la-razon-de-posibilidades"><i class="fa fa-check"></i><b>1.10.5</b> Intervalos de confianza para la razón de posibilidades</a></li>
<li class="chapter" data-level="1.10.6" data-path="inference.html"><a href="inference.html#correccion-de-recuento-pequeno"><i class="fa fa-check"></i><b>1.10.6</b> Corrección de recuento pequeño</a></li>
<li class="chapter" data-level="1.10.7" data-path="inference.html"><a href="inference.html#muestras-grandes-valores-p-pequenos"><i class="fa fa-check"></i><b>1.10.7</b> Muestras grandes, valores p pequeños</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="inference.html"><a href="inference.html#ejercicios-3"><i class="fa fa-check"></i><b>1.11</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>2</b> Modelos estadísticos</a><ul>
<li class="chapter" data-level="2.1" data-path="models.html"><a href="models.html#agregadores-de-encuestas"><i class="fa fa-check"></i><b>2.1</b> Agregadores de encuestas</a><ul>
<li class="chapter" data-level="2.1.1" data-path="models.html"><a href="models.html#datos-de-encuesta"><i class="fa fa-check"></i><b>2.1.1</b> Datos de encuesta</a></li>
<li class="chapter" data-level="2.1.2" data-path="models.html"><a href="models.html#sesgo-de-encuestador"><i class="fa fa-check"></i><b>2.1.2</b> Sesgo de encuestador</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="models.html"><a href="models.html#data-driven-model"><i class="fa fa-check"></i><b>2.2</b> Modelos basados en datos</a></li>
<li class="chapter" data-level="2.3" data-path="models.html"><a href="models.html#ejercicios-4"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="models.html"><a href="models.html#bayesian-statistics"><i class="fa fa-check"></i><b>2.4</b> Estadísticas bayesianas</a><ul>
<li class="chapter" data-level="2.4.1" data-path="models.html"><a href="models.html#teorema-de-bayes"><i class="fa fa-check"></i><b>2.4.1</b> Teorema de Bayes</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="models.html"><a href="models.html#simulacion-del-teorema-de-bayes"><i class="fa fa-check"></i><b>2.5</b> Simulación del teorema de Bayes</a><ul>
<li class="chapter" data-level="2.5.1" data-path="models.html"><a href="models.html#bayes-en-la-practica"><i class="fa fa-check"></i><b>2.5.1</b> Bayes en la práctica</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="models.html"><a href="models.html#modelos-jerarquicos"><i class="fa fa-check"></i><b>2.6</b> Modelos jerárquicos</a></li>
<li class="chapter" data-level="2.7" data-path="models.html"><a href="models.html#ejercicios-5"><i class="fa fa-check"></i><b>2.7</b> Ejercicios</a></li>
<li class="chapter" data-level="2.8" data-path="models.html"><a href="models.html#election-forecasting"><i class="fa fa-check"></i><b>2.8</b> Estudio de caso: pronóstico de elecciones</a><ul>
<li class="chapter" data-level="2.8.1" data-path="models.html"><a href="models.html#bayesian-approach"><i class="fa fa-check"></i><b>2.8.1</b> Enfoque bayesiano</a></li>
<li class="chapter" data-level="2.8.2" data-path="models.html"><a href="models.html#el-sesgo-general"><i class="fa fa-check"></i><b>2.8.2</b> El sesgo general</a></li>
<li class="chapter" data-level="2.8.3" data-path="models.html"><a href="models.html#representaciones-matematicas-de-modelos."><i class="fa fa-check"></i><b>2.8.3</b> Representaciones matemáticas de modelos.</a></li>
<li class="chapter" data-level="2.8.4" data-path="models.html"><a href="models.html#prediciendo-el-colegio-electoral"><i class="fa fa-check"></i><b>2.8.4</b> Prediciendo el colegio electoral</a></li>
<li class="chapter" data-level="2.8.5" data-path="models.html"><a href="models.html#prevision"><i class="fa fa-check"></i><b>2.8.5</b> Previsión</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="models.html"><a href="models.html#ejercicios-6"><i class="fa fa-check"></i><b>2.9</b> Ejercicios</a></li>
<li class="chapter" data-level="2.10" data-path="models.html"><a href="models.html#t-dist"><i class="fa fa-check"></i><b>2.10</b> La distribución t</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="inference" class="section level1">
<h1><span class="header-section-number">Capítulo 1</span> Inferencia estadística</h1>
<p>En el Capítulo@ref (modelos) describiremos, con cierto detalle, cómo los agregadores de encuestas como FiveThirtyEight usan los datos para predecir los resultados de las elecciones. Para comprender cómo lo hacen, primero debemos aprender los conceptos básicos de <em>Inferencia estadística</em>, la parte de la estadística que ayuda a distinguir los patrones que surgen de la señal de los que surgen de la casualidad. La inferencia estadística es un tema amplio y aquí repasaremos los conceptos básicos utilizando las encuestas como un ejemplo motivador. Para describir los conceptos, complementamos las fórmulas matemáticas con simulaciones de Monte Carlo y código R.</p>
<div id="encuestas" class="section level2">
<h2><span class="header-section-number">1.1</span> Encuestas</h2>
<p>Las encuestas de opinión se han llevado a cabo desde el siglo XIX. El objetivo general es describir las opiniones de una población específica sobre un conjunto de temas dado. En los últimos tiempos, estas encuestas han sido generalizadas durante las elecciones presidenciales. Las encuestas son útiles cuando entrevistar a cada miembro de una población en particular es logísticamente imposible. La estrategia general es entrevistar a un grupo más pequeño, elegido al azar, y luego inferir las opiniones de toda la población a partir de las opiniones del grupo más pequeño. La teoría estadística se usa para justificar el proceso. Esta teoría se conoce como <em>inferencia</em> y es el tema principal de este capítulo.</p>
<p>Quizás las encuestas de opinión más conocidas son las realizadas para determinar qué candidato es preferido por los votantes en una elección determinada. Los estrategas políticos hacen un uso extensivo de las encuestas para decidir, entre otras cosas, cómo invertir recursos. Por ejemplo, es posible que quieran saber en qué ubicaciones geográficas enfocar sus esfuerzos de “sacar el voto”.</p>
<p>Las elecciones son un caso particularmente interesante de encuestas de opinión porque la opinión real de toda la población se revela el día de las elecciones. Por supuesto, cuesta millones de dólares realizar una elección real, lo que hace que la votación sea una estrategia rentable para aquellos que desean pronosticar los resultados.</p>
<p>Aunque típicamente los resultados de estas encuestas se mantienen privados, las organizaciones de noticias realizan encuestas similares porque los resultados tienden a ser de interés para el público en general y se hacen públicos. Eventualmente estaremos viendo tales datos.</p>
<p>Real Clear Politics ^ [<a href="http://www.realclearpolitics.com" class="uri">http://www.realclearpolitics.com</a>] es un ejemplo de un agregador de noticias que organiza y publica resultados de encuestas. Por ejemplo, presentan los siguientes resultados de las encuestas que informan estimaciones del voto popular para las elecciones presidenciales de 2016 ^ [<a href="http://www.realclearpolitics.com/epolls/2016/president/us/general_election_trump_vs_clinton-5491.html" class="uri">http://www.realclearpolitics.com/epolls/2016/president/us/general_election_trump_vs_clinton-5491.html</a>]:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Poll
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Sample
</th>
<th style="text-align:left;">
MoE
</th>
<th style="text-align:right;">
Clinton
</th>
<th style="text-align:right;">
Trump
</th>
<th style="text-align:left;">
Spread
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Final Results
</td>
<td style="text-align:left;">
–
</td>
<td style="text-align:left;">
–
</td>
<td style="text-align:left;">
–
</td>
<td style="text-align:right;">
48.2
</td>
<td style="text-align:right;">
46.1
</td>
<td style="text-align:left;">
Clinton +2.1
</td>
</tr>
<tr>
<td style="text-align:left;">
RCP Average
</td>
<td style="text-align:left;">
11/1 - 11/7
</td>
<td style="text-align:left;">
–
</td>
<td style="text-align:left;">
–
</td>
<td style="text-align:right;">
46.8
</td>
<td style="text-align:right;">
43.6
</td>
<td style="text-align:left;">
Clinton +3.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Bloomberg
</td>
<td style="text-align:left;">
11/4 - 11/6
</td>
<td style="text-align:left;">
799 LV
</td>
<td style="text-align:left;">
3.5
</td>
<td style="text-align:right;">
46.0
</td>
<td style="text-align:right;">
43.0
</td>
<td style="text-align:left;">
Clinton +3
</td>
</tr>
<tr>
<td style="text-align:left;">
IBD
</td>
<td style="text-align:left;">
11/4 - 11/7
</td>
<td style="text-align:left;">
1107 LV
</td>
<td style="text-align:left;">
3.1
</td>
<td style="text-align:right;">
43.0
</td>
<td style="text-align:right;">
42.0
</td>
<td style="text-align:left;">
Clinton +1
</td>
</tr>
<tr>
<td style="text-align:left;">
Economist
</td>
<td style="text-align:left;">
11/4 - 11/7
</td>
<td style="text-align:left;">
3669 LV
</td>
<td style="text-align:left;">
–
</td>
<td style="text-align:right;">
49.0
</td>
<td style="text-align:right;">
45.0
</td>
<td style="text-align:left;">
Clinton +4
</td>
</tr>
<tr>
<td style="text-align:left;">
LA Times
</td>
<td style="text-align:left;">
11/1 - 11/7
</td>
<td style="text-align:left;">
2935 LV
</td>
<td style="text-align:left;">
4.5
</td>
<td style="text-align:right;">
44.0
</td>
<td style="text-align:right;">
47.0
</td>
<td style="text-align:left;">
Trump +3
</td>
</tr>
<tr>
<td style="text-align:left;">
ABC
</td>
<td style="text-align:left;">
11/3 - 11/6
</td>
<td style="text-align:left;">
2220 LV
</td>
<td style="text-align:left;">
2.5
</td>
<td style="text-align:right;">
49.0
</td>
<td style="text-align:right;">
46.0
</td>
<td style="text-align:left;">
Clinton +3
</td>
</tr>
<tr>
<td style="text-align:left;">
FOX News
</td>
<td style="text-align:left;">
11/3 - 11/6
</td>
<td style="text-align:left;">
1295 LV
</td>
<td style="text-align:left;">
2.5
</td>
<td style="text-align:right;">
48.0
</td>
<td style="text-align:right;">
44.0
</td>
<td style="text-align:left;">
Clinton +4
</td>
</tr>
<tr>
<td style="text-align:left;">
Monmouth
</td>
<td style="text-align:left;">
11/3 - 11/6
</td>
<td style="text-align:left;">
748 LV
</td>
<td style="text-align:left;">
3.6
</td>
<td style="text-align:right;">
50.0
</td>
<td style="text-align:right;">
44.0
</td>
<td style="text-align:left;">
Clinton +6
</td>
</tr>
<tr>
<td style="text-align:left;">
NBC News
</td>
<td style="text-align:left;">
11/3 - 11/5
</td>
<td style="text-align:left;">
1282 LV
</td>
<td style="text-align:left;">
2.7
</td>
<td style="text-align:right;">
48.0
</td>
<td style="text-align:right;">
43.0
</td>
<td style="text-align:left;">
Clinton +5
</td>
</tr>
<tr>
<td style="text-align:left;">
CBS News
</td>
<td style="text-align:left;">
11/2 - 11/6
</td>
<td style="text-align:left;">
1426 LV
</td>
<td style="text-align:left;">
3.0
</td>
<td style="text-align:right;">
47.0
</td>
<td style="text-align:right;">
43.0
</td>
<td style="text-align:left;">
Clinton +4
</td>
</tr>
<tr>
<td style="text-align:left;">
Reuters
</td>
<td style="text-align:left;">
11/2 - 11/6
</td>
<td style="text-align:left;">
2196 LV
</td>
<td style="text-align:left;">
2.3
</td>
<td style="text-align:right;">
44.0
</td>
<td style="text-align:right;">
39.0
</td>
<td style="text-align:left;">
Clinton +5
</td>
</tr>
</tbody>
</table>
<!-- (Source: [Real Clear Politics](https://www.realclearpolitics.com/epolls/2016/president/us/general_election_trump_vs_clinton-5491.html)) -->
<p>Aunque en los Estados Unidos el voto popular no determina el resultado de las elecciones presidenciales, lo utilizaremos como un ejemplo ilustrativo y simple de qué tan bien funcionan las encuestas. Pronosticar la elección es un proceso más complejo ya que implica combinar resultados de 50 estados y DC y lo describimos en la Sección@ref (pronóstico de elecciones).</p>
<p>Hagamos algunas observaciones sobre la tabla de arriba. Primero, tenga en cuenta que las encuestas diferentes, todas tomadas días antes de las elecciones, informan una <em>difusión</em> diferente: la diferencia estimada entre el apoyo a los dos candidatos. Observe también que los diferenciales informados rondan en torno a lo que terminó siendo el resultado real: Clinton ganó el voto popular en un 2,1%. También vemos una columna titulada ** MoE ** que significa <em>margin of error</em>.</p>
<p>En esta sección, mostraremos cómo se pueden aplicar los conceptos de probabilidad que aprendimos en el capítulo anterior para desarrollar los enfoques estadísticos que hacen de las encuestas una herramienta eficaz. Aprenderemos los conceptos estadísticos necesarios para definir estimaciones y márgenes de errores, y mostraremos cómo podemos usarlos para pronosticar resultados finales relativamente bien y también proporcionar una estimación de la precisión de nuestro pronóstico. Una vez que aprendamos esto, podremos comprender dos conceptos que son ubicuos en la ciencia de datos: <em>intervalos de confianza</em> y <em>p-valores</em>. Finalmente, para comprender las declaraciones probabilísticas sobre la probabilidad de que un candidato gane, tendremos que aprender sobre el modelado bayesiano. En las secciones finales, lo reunimos todo para recrear la versión simplificada del modelo FiveThirtyEight y aplicarlo a las elecciones de 2016.</p>
<p>Comenzamos conectando la teoría de probabilidad con la tarea de usar encuestas para aprender sobre una población.</p>
<div id="el-modelo-de-muestreo-para-encuestas" class="section level3">
<h3><span class="header-section-number">1.1.1</span> El modelo de muestreo para encuestas</h3>
<p>Para ayudarnos a comprender la conexión entre las encuestas y lo que hemos aprendido, construyamos una situación similar a la que enfrentan los encuestadores. Para imitar el desafío que enfrentan los encuestadores reales en términos de competir con otros encuestadores por la atención de los medios, utilizaremos una urna llena de cuentas para representar a los votantes y fingiremos que estamos compitiendo por un premio de $ 25 dólares. El desafío es adivinar la extensión entre la proporción de cuentas azules y rojas en esta urna (en este caso, un tarro de pepinillos):</p>
<p><img src="inference/img//urn.jpg" width="1.5in" style="display: block; margin: auto;" /></p>
<p>Antes de hacer una predicción, puede tomar una muestra (con reemplazo) de la urna. Para imitar el hecho de que realizar encuestas es costoso, te cuesta$0.10 per each bead you sample. Therefore, if your sample size is 250, and you win, you will break even since you will pay$ 25 para recoger su premio de $ 25. Su entrada en la competencia puede ser un intervalo. Si el intervalo que envía contiene la proporción real, obtiene la mitad de lo que pagó y pasa a la segunda fase de la competencia. En la segunda fase, la entrada con el intervalo más pequeño se selecciona como el ganador.</p>
<p>El paquete <strong>dslabs</strong> incluye una función que muestra un sorteo aleatorio de esta urna:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(dslabs)
<span class="kw">take_poll</span>(<span class="dv">25</span>)</code></pre></div>
<p><img src="libro_files/figure-html/first-simulated-poll-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Piense en cómo construiría su intervalo según los datos que se muestran arriba.</p>
<p>Acabamos de describir un modelo de muestreo simple para encuestas de opinión. Las cuentas dentro de la urna representan a las personas que votarán el día de las elecciones. Los que votarán por el candidato republicano están representados con cuentas rojas y los demócratas con cuentas azules. Por simplicidad, suponga que no hay otros colores. Es decir, que solo hay dos partidos: republicano y demócrata.</p>
</div>
</div>
<div id="poblaciones-muestras-parametros-y-estimaciones" class="section level2">
<h2><span class="header-section-number">1.2</span> Poblaciones, muestras, parámetros y estimaciones</h2>
<p>Queremos predecir la proporción de cuentas azules en la urna. Llamemos a esta cantidad <span class="math inline">\(p\)</span>, que luego nos dice la proporción de cuentas rojas <span class="math inline">\(1-p\)</span>y la propagación <span class="math inline">\(p - (1-p)\)</span>, que se simplifica a <span class="math inline">\(2p - 1\)</span>.</p>
<p>En los libros de texto estadísticos, las cuentas en la urna se llaman <em>población</em>. La proporción de cuentas azules en la población. <span class="math inline">\(p\)</span> se llama un parámetro Las 25 cuentas que vemos en la gráfica anterior se llaman <em>muestra</em>. La tarea de la inferencia estadística es predecir el parámetro. <span class="math inline">\(p\)</span> utilizando los datos observados en la muestra.</p>
<p>¿Podemos hacer esto con las 25 observaciones anteriores? Ciertamente es informativo. Por ejemplo, dado que vemos 13 cuentas rojas y 12 azules, es poco probable que <span class="math inline">\(p\)</span> &gt; .9 o <span class="math inline">\(p\)</span> ≪.1. ¿Pero estamos listos para predecir con certeza que hay más cuentas rojas que azules en el frasco?</p>
<p>Queremos construir una estimación de <span class="math inline">\(p\)</span> utilizando solo la información que observamos. Una estimación debe considerarse como un resumen de los datos observados que consideramos informativos sobre el parámetro de interés. Parece intuitivo pensar que la proporción de cuentas azules en la muestra <span class="math inline">\(0.48\)</span> debe estar al menos relacionado con la proporción real <span class="math inline">\(p\)</span>. ¿Pero simplemente predecimos <span class="math inline">\(p\)</span> ser 0.48? Primero, recuerde que la proporción muestral es una variable aleatoria. Si ejecutamos el comando <code>take_poll(25)</code> cuatro veces, obtenemos una respuesta diferente cada vez, ya que la proporción muestral es una variable aleatoria.</p>
<p><img src="libro_files/figure-html/four-simulated-polls-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Tenga en cuenta que en las cuatro muestras aleatorias que se muestran arriba, las proporciones de la muestra varían de 0.44 a 0.60. Al describir la distribución de esta variable aleatoria, podremos obtener información sobre cuán buena es esta estimación y cómo podemos mejorarla.</p>
<div id="el-promedio-de-la-muestra" class="section level3">
<h3><span class="header-section-number">1.2.1</span> El promedio de la muestra</h3>
<p>La realización de una encuesta de opinión se modela como la toma de una muestra aleatoria de una urna. Estamos proponiendo el uso de la proporción de cuentas azules en nuestra muestra como una estimación del parámetro <span class="math inline">\(p\)</span>. Una vez que tengamos este estimado, podemos reportar fácilmente un estimado para el spread <span class="math inline">\(2p-1\)</span>, pero por simplicidad ilustraremos los conceptos para estimar <span class="math inline">\(p\)</span>. Usaremos nuestro conocimiento de probabilidad para defender nuestro uso de la proporción muestral y cuantificaremos qué tan cerca creemos que está de la proporción poblacional <span class="math inline">\(p\)</span>.</p>
<p>Comenzamos definiendo la variable aleatoria <span class="math inline">\(X\)</span> como: <span class="math inline">\(X=1\)</span> si elegimos una cuenta azul al azar y <span class="math inline">\(X=0\)</span> si es rojo Esto implica que la población es una lista de 0s y 1s. Si tomamos muestras <span class="math inline">\(N\)</span> cuentas, entonces el promedio de los sorteos <span class="math inline">\(X_1,\dots, X_N\)</span> es equivalente a la proporción de cuentas azules en nuestra muestra. Esto es porque agregar el <span class="math inline">\(X\)</span> s es equivalente a contar las cuentas azules y dividir este recuento por el total <span class="math inline">\(N\)</span> es equivalente a calcular una proporción. Usamos el símbolo ${X} $ to represent this average. In general, in statistics textbooks a bar on top of a symbol means the average. The theory we just learned about the sum of draws becomes useful because the average is a sum of draws multiplied by the constant $ 1/ N $:</p>
<p><span class="math display">\[\bar{X} = 1/N\times\sum_{i=1}^N X_i\]</span></p>
<p>For simplicity, let’s assume that the draws are independent: after we see each sampled bead, we return it to the urn. In this case, what do we know about the distribution of the sum of draws? First, we know that the expected value of the sum of draws is <span class="math inline">\(N\)</span> times the average of the values in the urn. We know that the average of the 0s and 1s in the urn must be <span class="math inline">\(p\)</span>, the proportion of blue beads.</p>
<p>Here we encounter an important difference with what we did in the Probability chapter: we don’t know what is in the urn. We know there are blue and red beads, but we don’t know how many of each. This is what we want to find out: we are trying to <strong>estimate</strong> <span class="math inline">\(p\)</span>.</p>
</div>
<div id="parameters" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Parameters</h3>
<p>Just like we use variables to define unknowns in systems of equations, in statistical inference we define <em>parameters</em> to define unknown parts of our models. In the urn model which we are using to mimic an opinion poll, we do not know the proportion of blue beads in the urn. We define the parameters <span class="math inline">\(p\)</span> to represent this quantity. <span class="math inline">\(p\)</span> is the average of the urn because if we take the average of the 1s (blue) and 0s (red), we get the proportion of blue beads. Since our main goal is figuring out what is <span class="math inline">\(p\)</span>, we are going to <em>estimate this parameter</em>.</p>
<p>The ideas presented here on how we estimate parameters, and provide insights into how good these estimates are, extrapolate to many data science tasks. For example, we may want to determine the difference in health improvement between patients receiving treatment and a control group. We may ask, what are the health effects of smoking on a population? What are the differences in racial groups of fatal shootings by police? What is the rate of change in life expectancy in the US during the last 10 years? All these questions can be framed as a task of estimating a parameter from a sample.</p>
</div>
<div id="polling-versus-forecasting" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Polling versus forecasting</h3>
<p>Before we continue, let’s make an important clarification related to the practical problem of forecasting the election. If a poll is conducted four months before the election, it is estimating the <span class="math inline">\(p\)</span> for that moment and not for election day. The <span class="math inline">\(p\)</span> for election night might be different since people’s opinions fluctuate through time. The polls provided the night before the election tend to be the most accurate since opinions don’t change that much in a day. However, forecasters try to build tools that model how opinions vary across time and try to predict the election night results taking into consideration the fact that opinions fluctuate. We will describe some approaches for doing this in a later section.</p>
</div>
<div id="properties-of-our-estimate-expected-value-and-standard-error" class="section level3">
<h3><span class="header-section-number">1.2.4</span> Properties of our estimate: expected value and standard error</h3>
<p>To understand how good our estimate is, we will describe the statistical properties of the random variable defined above: the sample proportion <span class="math inline">\(\bar{X}\)</span>. Remember that <span class="math inline">\(\bar{X}\)</span> is the sum of independent draws so the rules we covered in the probability chapter apply.</p>
<p>Using what we have learned, the expected value of the sum <span class="math inline">\(N\bar{X}\)</span> is <span class="math inline">\(N\times\)</span> the average of the urn, <span class="math inline">\(p\)</span>. So dividing by the non-random constant <span class="math inline">\(N\)</span> gives us that the expected value of the average <span class="math inline">\(\bar{X}\)</span> is <span class="math inline">\(p\)</span>. We can write it using our mathematical notation:</p>
<p><span class="math display">\[
\mbox {E}(\bar {X}) = p
\]</span></p>
<p>We can also use what we learned to figure out the standard error: the standard error of the sum is <span class="math inline">\(\sqrt{N}\times\)</span> the standard deviation of the urn. Can we compute the standard error of the urn? We learned a formula that tells us that it is <span class="math inline">\((1-0)\sqrt{p (1-p)}\)</span> = <span class="math inline">\(\sqrt{p (1-p)}\)</span>. Because we are dividing the sum by <span class="math inline">\(N\)</span>, we arrive at the following formula for the standard error of the average:</p>
<p><span class="math display">\[
\mbox {SE}(\bar {X}) =\sqrt {p(1-p)/N}
\]</span></p>
<p>Este resultado revela el poder de las encuestas. El valor esperado de la proporción de muestra ${X} $ is the parameter of interest $ pag $ and we can make the standard error as small as we want by increasing $ Norte $. The law of large numbers tells us that with a large enough poll, our estimate converges to $ p $.</p>
<p>Si realizamos una encuesta lo suficientemente grande como para que nuestro error estándar sea del 1%, estaremos bastante seguros de quién ganará. Pero, ¿qué tan grande debe ser la encuesta para que el error estándar sea tan pequeño?</p>
<p>Un problema es que no sabemos <span class="math inline">\(p\)</span>, por lo que no podemos calcular el error estándar. Sin embargo, con fines ilustrativos, supongamos que <span class="math inline">\(p=0.51\)</span> y trazar el error estándar frente al tamaño de la muestra <span class="math inline">\(N\)</span>:</p>
<p><img src="libro_files/figure-html/standard-error-versus-sample-size-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>De la trama vemos que necesitaríamos una encuesta de más de 10,000 personas para obtener el error estándar tan bajo. Raramente vemos encuestas de este tamaño debido en parte a los costos. De la tabla Real Clear Politics, aprendemos que los tamaños de muestra en las encuestas de opinión oscilan entre 500-3,500 personas. Para un tamaño de muestra de 1,000 y <span class="math inline">\(p=0.51\)</span>, el error estándar es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1000</span>)
<span class="co">#&gt; [1] 0.0158</span></code></pre></div>
<p>o 1.5 puntos porcentuales. Entonces, incluso con grandes encuestas, para elecciones cerradas, ${X} $ can lead us astray if we don’t realize it is a random variable. Nonetheless, we can actually say more about how close we get the $ p $ y lo hacemos en la Sección@ref (clt).</p>
</div>
</div>
<div id="ejercicios" class="section level2">
<h2><span class="header-section-number">1.3</span> Ejercicios</h2>
<p>1. Supongamos que sondea una población en la que una proporción <span class="math inline">\(p\)</span> de los votantes son demócratas y <span class="math inline">\(1-p\)</span> son republicanos Su tamaño de muestra es <span class="math inline">\(N=25\)</span>. Considere la variable aleatoria <span class="math inline">\(S\)</span> que es el ** total ** número de demócratas en su muestra. ¿Cuál es el valor esperado de esta variable aleatoria? Sugerencia: es una función de <span class="math inline">\(p\)</span>.</p>
<p>2. ¿Cuál es el error estándar de <span class="math inline">\(S\)</span> ? Sugerencia: es una función de <span class="math inline">\(p\)</span>.</p>
<p>3. Considere la variable aleatoria <span class="math inline">\(S/N\)</span>. Esto es equivalente al promedio de la muestra, que hemos estado denotando como ${X} $. What is the expected value of the ${X} $? Hint: it’s a function of $ p $.</p>
<p>4. ¿Cuál es el error estándar de $? {X} $? Hint: it’s a function of $ p $.</p>
<p>5. Escribe una línea de código que te dé el error estándar <code>se</code> para el problema anterior para varios valores de <span class="math inline">\(p\)</span>, especificamente para <code>p &lt;- seq(0, 1, length = 100)</code>. Haz una trama de <code>se</code> versus <code>p</code>.</p>
<p>6. Copie el código anterior y póngalo dentro de un bucle for para hacer el diagrama para <span class="math inline">\(N=25\)</span>, <span class="math inline">\(N=100\)</span>y <span class="math inline">\(N=1000\)</span>.</p>
<p>7. Si nos interesa la diferencia en proporciones, <span class="math inline">\(p - (1-p)\)</span>, nuestra estimación es $ d ={X} - (1-{X})$. Use the rules we learned about sums of random variables and scaled random variables to derive the expected value of $ d $.</p>
<p>8. ¿Cuál es el error estándar de <span class="math inline">\(d\)</span>?</p>
<p>9. Si el actual <span class="math inline">\(p=.45\)</span>, significa que los republicanos están ganando por un margen relativamente grande desde <span class="math inline">\(d= -.1\)</span>, que es un margen de victoria del 10%. En este caso, ¿cuál es el error estándar de $ 2-1$ if we take a sample of $ N = 25 $?</p>
<p>10. Dada la respuesta a 9, ¿cuál de las siguientes opciones describe mejor su estrategia de usar un tamaño de muestra de <span class="math inline">\(N=25\)</span>?</p>
<ol style="list-style-type: lower-alpha">
<li>El valor esperado de nuestro estimado $ 2{X}-1$ is $ d $, por lo que nuestra predicción será correcta. si. Nuestro error estándar es mayor que la diferencia, por lo que las posibilidades de $ 2{X}-1 $ siendo positivo y arrojándonos no fueron tan pequeños. Deberíamos elegir un tamaño de muestra más grande.</li>
<li>La diferencia es del 10% y el error estándar es de aproximadamente 0.2, por lo tanto, mucho más pequeño que la diferencia. re. Porque no sabemos <span class="math inline">\(p\)</span>, no tenemos forma de saber que hacer <span class="math inline">\(N\)</span> más grande en realidad mejoraría nuestro error estándar.</li>
</ol>

</div>
<div id="clt" class="section level2">
<h2><span class="header-section-number">1.4</span> Teorema del límite central en la práctica</h2>
<p>El CLT nos dice que la función de distribución para una suma de sorteos es aproximadamente normal. También aprendimos que dividir una variable aleatoria normalmente distribuida por una constante también es una variable normalmente distribuida. Esto implica que la distribución de <span class="math inline">\(\bar {X}\)</span> es aproximadamente normal.</p>
<p>En resumen, tenemos ese ${X} $ has an approximately normal distribution with expected value $ pag $ and standard error <span class="math inline">\(\sqrt {p(1-p)/N}\)</span>.</p>
<p>Ahora, ¿cómo nos ayuda esto? Supongamos que queremos saber cuál es la probabilidad de que estemos dentro del 1% de <span class="math inline">\(p\)</span>. Básicamente estamos preguntando qué es</p>
<p><span class="math display">\[
\mbox{Pr}(|\bar{X} - p|\leq .01)
\]</span> que es lo mismo que:</p>
<p><span class="math display">\[
\mbox{Pr}(\bar{X}\leq p + .01) -\mbox{Pr}(\bar{X}\leq p - .01)
\]</span></p>
<p>¿Podemos responder esta pregunta? Podemos usar el truco matemático que aprendimos en el capítulo anterior. Reste el valor esperado y divida por el error estándar para obtener una variable aleatoria normal estándar, llámela <span class="math inline">\(Z\)</span>, a la izquierda. Ya que <span class="math inline">\(p\)</span> es el valor esperado y <span class="math inline">\(\mbox {SE}(\bar {X}) =\sqrt {p(1-p)/N}\)</span> es el error estándar que obtenemos:</p>
<p><span class="math display">\[
\mbox{Pr}\left(Z\leq\frac{\,.01} {\mbox{SE}(\bar{X})}\right) -
\mbox{Pr}\left(Z\leq -\frac{\,.01} {\mbox{SE}(\bar{X})}\right)
\]</span></p>
<p>Un problema que tenemos es que no sabemos <span class="math inline">\(p\)</span>, no sabemos <span class="math inline">\(\mbox {SE}(\bar {X})\)</span>. But it turns out that the CLT still works if we estimate the standard error by using ${X} $ in place of $ p $. Decimos que enchufamos la estimación. Nuestra estimación del error estándar es por lo tanto:</p>
<p><span class="math display">\[
\hat{\mbox{SE}}(\bar{X})=\sqrt{\bar{X}(1-\bar{X})/N}
\]</span> En los libros de texto de estadísticas, usamos un sombrerito para denotar estimaciones. La estimación se puede construir utilizando los datos observados y <span class="math inline">\(N\)</span>.</p>
<p>Ahora continuamos con nuestro cálculo, pero dividiendo por $({X}) =) $ instead. In our first sample we had 12 blue and 13 red so ${X} = 0.48 $ y nuestra estimación del error estándar es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x_hat &lt;-<span class="st"> </span><span class="fl">0.48</span>
se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(x_hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x_hat)<span class="op">/</span><span class="dv">25</span>)
se
<span class="co">#&gt; [1] 0.0999</span></code></pre></div>
<p>Y ahora podemos responder a la pregunta de la probabilidad de estar cerca de <span class="math inline">\(p\)</span>. La respuesta es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="fl">0.01</span><span class="op">/</span>se) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">0.01</span><span class="op">/</span>se)
<span class="co">#&gt; [1] 0.0797</span></code></pre></div>
<p>Por lo tanto, existe una pequeña posibilidad de que estemos cerca. Una encuesta de solo <span class="math inline">\(N=25\)</span> la gente no es realmente muy útil, al menos no para una elección cerrada.</p>
<p>Anteriormente mencionamos el <em>margen de error</em>. Ahora podemos definirlo porque es simplemente dos veces el error estándar, que ahora podemos estimar. En nuestro caso es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="fl">1.96</span><span class="op">*</span>se
<span class="co">#&gt; [1] 0.196</span></code></pre></div>
<p>¿Por qué multiplicamos por 1.96? Porque si pregunta cuál es la probabilidad de que estemos dentro de 1.96 errores estándar de <span class="math inline">\(p\)</span>, obtenemos:</p>
<p><span class="math display">\[
\mbox{Pr}\left(Z\leq\, 1.96\,\mbox{SE}(\bar{X})/\mbox{SE}(\bar{X})\right) -
\mbox{Pr}\left(Z\leq - 1.96\,\mbox{SE}(\bar{X})/\mbox{SE}(\bar{X})\right)
\]</span> cual es:</p>
<p><span class="math display">\[
\mbox{Pr}\left(Z\leq 1.96\right) -
\mbox{Pr}\left(Z\leq - 1.96\right)
\]</span></p>
<p>que sabemos es aproximadamente 95%:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="fl">1.96</span>)<span class="op">-</span><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">1.96</span>)
<span class="co">#&gt; [1] 0.95</span></code></pre></div>
<p>Por lo tanto, hay un 95% de probabilidad de que ${X} $ will be within $ 1.96({X}) $, en nuestro caso dentro de aproximadamente 0.2de <span class="math inline">\(p\)</span>. Tenga en cuenta que el 95% es una elección arbitraria y, a veces, se utilizan otros porcentajes, pero es el valor más utilizado para definir el margen de error. A menudo redondeamos 1.96 hasta 2 para simplificar la presentación.</p>
<p>En resumen, el CLT nos dice que nuestra encuesta se basa en un tamaño de muestra de <span class="math inline">\(25\)</span> no es muy útil. Realmente no aprendemos mucho cuando el margen de error es tan grande. Todo lo que realmente podemos decir es que el voto popular no se ganará por un amplio margen. Esta es la razón por la cual los encuestadores tienden a usar muestras de mayor tamaño.</p>
<p>En la tabla anterior, vemos que los tamaños de muestra típicos oscilan entre 700 y 3500. Para ver cómo esto nos da un resultado mucho más práctico, tenga en cuenta que si hubiéramos obtenido un ${X} $=0.48 with a sample size of 2,000, our standard error $({X}) $ habría sido 0.011. Entonces nuestro resultado es una estimación de <code>48</code>% con un margen de error de 2% En este caso, el resultado es mucho más informativo y nos haría pensar que hay más bolas rojas que azules. Tenga en cuenta, sin embargo, que esto es hipotético. No hicimos una encuesta de 2,000 ya que no queremos arruinar la competencia.</p>
<div id="una-simulacion-de-monte-carlo" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Una simulación de Monte Carlo</h3>
<p>Supongamos que queremos usar una simulación de Monte Carlo para corroborar las herramientas que hemos construido utilizando la teoría de la probabilidad. Para crear la simulación, escribiríamos código como este:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">B &lt;-<span class="st"> </span><span class="dv">10000</span>
N &lt;-<span class="st"> </span><span class="dv">1000</span>
x_hat &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {
x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">size =</span> N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p))
<span class="kw">mean</span>(x)
})</code></pre></div>
<p>El problema es, por supuesto, que no sabemos <code>p</code>. Podríamos construir una urna como la que se muestra arriba y ejecutar una simulación analógica (sin computadora). Llevaría mucho tiempo, pero podría tomar 10,000 muestras, contar las cuentas y realizar un seguimiento de las proporciones de azul. Podemos usar la función <code>take_poll(n=1000)</code> en lugar de dibujar desde una urna real, pero todavía tomaría tiempo contar las cuentas e ingresar los resultados.</p>
<p>Por lo tanto, una cosa que hacemos para corroborar los resultados teóricos es elegir uno o varios valores de <code>p</code> y ejecuta las simulaciones. Vamos a configurar <code>p=0.45</code>. Entonces podemos simular una encuesta:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="fl">0.45</span>
N &lt;-<span class="st"> </span><span class="dv">1000</span>
x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">size =</span> N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p))
x_hat &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</code></pre></div>
<p>En esta muestra particular, nuestra estimación es <code>x_hat</code>. Podemos usar ese código para hacer una simulación de Monte Carlo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">B &lt;-<span class="st"> </span><span class="dv">10000</span>
x_hat &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {
x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">size =</span> N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p))
<span class="kw">mean</span>(x)
})</code></pre></div>
<p>Para revisar, la teoría nos dice que ${X} $ is approximately normally distributed, has expected value $ p = $ 0.45 y error estándar <span class="math inline">\(\sqrt {p(1-p)/N}\)</span> = 0.016. La simulación confirma esto:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(x_hat)
<span class="co">#&gt; [1] 0.45</span>
<span class="kw">sd</span>(x_hat)
<span class="co">#&gt; [1] 0.0157</span></code></pre></div>
<p>Un histograma y un gráfico qq confirman que la aproximación normal también es precisa:</p>
<p><img src="libro_files/figure-html/normal-approximation-for-polls-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Por supuesto, en la vida real nunca podríamos realizar un experimento así porque no sabemos <span class="math inline">\(p\)</span>. Pero podríamos ejecutarlo para varios valores de <span class="math inline">\(p\)</span> y <span class="math inline">\(N\)</span> y ver que la teoría realmente funciona bien para la mayoría de los valores. Puede hacerlo fácilmente volviendo a ejecutar el código anterior después de cambiar <code>p</code> y <code>N</code>.</p>
</div>
<div id="la-propagacion" class="section level3">
<h3><span class="header-section-number">1.4.2</span> La propagación</h3>
<p>La competencia es predecir la propagación, no la proporción. <span class="math inline">\(p\)</span>. Sin embargo, dado que suponemos que solo hay dos partes, sabemos que la propagación es <span class="math inline">\(p - (1-p) = 2p - 1\)</span>. Como resultado, todo lo que hemos hecho se puede adaptar fácilmente a una estimación de <span class="math inline">\(2p - 1\)</span>. Una vez que tengamos nuestro estimado ${X} $ and <span class="math inline">\(\sombrero {\mbox{SE}}(\bar {X})\)</span>, we estimate the spread with $ 2{X} - 1$ and, since we are multiplying by 2, the standard error is $ 2({X}PS Tenga en cuenta que restar 1 no agrega ninguna variabilidad, por lo que no afecta el error estándar.</p>
<p>Para nuestra muestra de 25 artículos anterior, nuestra estimación <span class="math inline">\(p\)</span> es <code>.48</code> con margen de error <code>.20</code> y nuestra estimación de la propagación es <code>0.04</code> con margen de error <code>.40</code>. Nuevamente, no es un tamaño de muestra muy útil. Sin embargo, el punto es que una vez que tenemos una estimación y un error estándar para <span class="math inline">\(p\)</span>, lo tenemos para difundir <span class="math inline">\(2p-1\)</span>.</p>
</div>
<div id="sesgo-por-que-no-realizar-una-encuesta-muy-grande" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Sesgo: ¿por qué no realizar una encuesta muy grande?</h3>
<p>Para valores realistas de <span class="math inline">\(p\)</span>, digamos de 0.35 a 0.65, si realizamos una encuesta muy grande con 100,000 personas, la teoría nos dice que predeciríamos la elección perfectamente ya que el mayor margen de error posible es de alrededor de 0.3%:</p>
<p><img src="libro_files/figure-html/standard-error-versus-p-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Una razón es que realizar una encuesta de este tipo es muy costosa. Otra razón posiblemente más importante es que la teoría tiene sus limitaciones. El sondeo es mucho más complicado que recoger cuentas de una urna. Algunas personas pueden mentir a los encuestadores y otras pueden no tener teléfonos. Pero quizás la forma más importante en que una encuesta real difiere de un modelo de urna es que en realidad no sabemos con certeza quién está en nuestra población y quién no. ¿Cómo sabemos quién va a votar? ¿Estamos llegando a todos los votantes posibles? Por lo tanto, incluso si nuestro margen de error es muy pequeño, podría no ser exactamente correcto que nuestro valor esperado sea <span class="math inline">\(p\)</span>. A esto lo llamamos sesgo. Históricamente, observamos que las encuestas están sesgadas, aunque no tanto. El sesgo típico parece ser de aproximadamente 1-2%. Esto hace que el pronóstico de las elecciones sea un poco más interesante y hablaremos sobre cómo modelar esto en un capítulo posterior.</p>
</div>
</div>
<div id="ejercicios-1" class="section level2">
<h2><span class="header-section-number">1.5</span> Ejercicios</h2>
<p>1. Escriba una función <em>urn model</em> que tome la proporción de demócratas <span class="math inline">\(p\)</span> y el tamaño de la muestra <span class="math inline">\(N\)</span> como argumentos y devuelve el promedio de la muestra si los demócratas son 1s y los republicanos son 0s. Llamar a la función <code>take_sample</code>.</p>
<p>2. Ahora asume <code>p &lt;- 0.45</code> y que su tamaño de muestra es <span class="math inline">\(N=100\)</span>. Tome una muestra 10,000 veces y guarde el vector de <code>mean(X) - p</code> en un objeto llamado <code>errors</code>. Sugerencia: use la función que escribió para el ejercicio 1 para escribir esto en una línea de código.</p>
<p>3. El vector <code>errors</code> contiene, para cada muestra simulada, la diferencia entre el valor real <span class="math inline">\(p\)</span> y nuestro estimado ${X}PS Nos referimos a esta diferencia como el <em>error</em>. Calcule el promedio y haga un histograma de los errores generados en la simulación de Monte Carlo y seleccione cuál de las siguientes opciones describe mejor sus distribuciones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(errors)
<span class="kw">hist</span>(errors)</code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Los errores son alrededor de 0.05. si. Los errores son todos acerca de -0.05.</li>
<li>Los errores se distribuyen simétricamente alrededor de 0. re. Los errores varían de -1 a 1.</li>
</ol>
<p>4. El error ${X}-pag $ is a random variable. In practice, the error is not observed because we do not know $ pag $. Here we observe it because we constructed the simulation. What is the average size of the error if we define the size by taking the absolute value ${X} - p$?</p>
<p>5. El error estándar está relacionado con el ** tamaño ** típico del error que cometemos al predecir. Decimos ** tamaño ** porque acabamos de ver que los errores están centrados alrededor de 0, por lo que el valor de error promedio es 0. Por razones matemáticas relacionadas con el Teorema del límite central, en realidad utilizamos la desviación estándar de <code>errors</code> en lugar del promedio de los valores absolutos para cuantificar el tamaño típico. ¿Cuál es esta desviación estándar de los errores?</p>
<p>6. La teoría que acabamos de aprender nos dice cuál será esta desviación estándar porque es el error estándar de ${X} $. What does theory tell us is the standard error of <span class="math inline">\(\bar {X}\)</span> para un tamaño de muestra de 100?</p>
<p>7. En la práctica, no sabemos <span class="math inline">\(p\)</span>, por lo que construimos una estimación de la predicción teórica basada en enchufar ${X} $ for $ p $. Calcule esta estimación. Establecer la semilla en 1 con <code>set.seed(1)</code>.</p>
<p>8. Observe qué tan cerca están las estimaciones de error estándar obtenidas de la simulación de Monte Carlo (ejercicio 5), la predicción teórica (ejercicio 6) y la estimación de la predicción teórica (ejercicio 7). La teoría está funcionando y nos da un enfoque práctico para conocer el error típico que cometeremos si predecimos <span class="math inline">\(p\)</span> con ${X} $. Another advantage that the theoretical result provides is that it gives an idea of how large a sample size is required to obtain the precision we need. Earlier we learned that the largest standard errors occur for $ p = 0.5 $. Create a plot of the largest standard error for $ N $ que van de 100 a 5,000. Según este gráfico, ¿qué tan grande debe ser el tamaño de la muestra para tener un error estándar de aproximadamente 1%?</p>
<ol style="list-style-type: lower-alpha">
<li>100 si. 500</li>
<li>2,500 re. 4,000</li>
</ol>
<p>9. Para el tamaño de la muestra <span class="math inline">\(N=100\)</span>, el teorema del límite central nos dice que la distribución de <span class="math inline">\(\bar {X}\)</span> es:</p>
<ol style="list-style-type: lower-alpha">
<li>prácticamente igual a <span class="math inline">\(p\)</span>. si. aproximadamente normal con el valor esperado <span class="math inline">\(p\)</span> y error estándar <span class="math inline">\(\sqrt {p(1-p)/N}\)</span>.</li>
<li>aproximadamente normal con valor esperado ${X} $ and standard error $ $. re. No es una variable aleatoria.</li>
</ol>
<p>10. Según la respuesta del ejercicio 8, el error ${X} - p $ es:</p>
<ol style="list-style-type: lower-alpha">
<li>prácticamente igual a 0. si. aproximadamente normal con el valor esperado <span class="math inline">\(0\)</span> y error estándar <span class="math inline">\(\sqrt {p(1-p)/N}\)</span>.</li>
<li>aproximadamente normal con el valor esperado <span class="math inline">\(p\)</span> y error estándar <span class="math inline">\(\sqrt {p(1-p)/N}\)</span>. re. No es una variable aleatoria.</li>
</ol>
<p>11. Para corroborar su respuesta al ejercicio 9, haga un diagrama qq de <code>errors</code> generaste en el ejercicio 2 para ver si siguen una distribución normal.</p>
<p>12. Si <span class="math inline">\(p=0.45\)</span> y <span class="math inline">\(N=100\)</span> como en el ejercicio 2, use el CLT para estimar la probabilidad de que <span class="math inline">\(\bar {X}&gt;0.5\)</span>. You can assume you know $ p = 0.45 $ para este cálculo.</p>
<p>13. Suponga que está en una situación práctica y no sabe <span class="math inline">\(p\)</span>. Tomar una muestra de tamaño <span class="math inline">\(N=100\)</span> y obtener un promedio de muestra de ${X} = 0.51 $. ¿Cuál es la aproximación CLT para la probabilidad de que su error sea igual o mayor que 0.01?</p>

</div>
<div id="intervalos-de-confianza" class="section level2">
<h2><span class="header-section-number">1.6</span> Intervalos de confianza</h2>
<p>Los intervalos de confianza son un concepto muy útil ampliamente utilizado por los analistas de datos. Una versión de estos que se ve comúnmente proviene del <code>ggplot</code> geometría <code>geom_smooth</code>. Aquí hay un ejemplo usando un conjunto de datos de temperatura disponible en R:</p>
<p><img src="libro_files/figure-html/first-confidence-intervals-example-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>En la parte de Aprendizaje automático, aprenderemos cómo se forma la curva, pero por ahora considere el área sombreada alrededor de la curva. Esto se crea utilizando el concepto de intervalos de confianza.</p>
<p>En nuestra competencia anterior, se le pidió que diera un intervalo. Si el intervalo que envió incluye el <span class="math inline">\(p\)</span>, obtiene la mitad del dinero que gastó en su “encuesta” y pasa a la siguiente etapa de la competencia. Una forma de pasar a la segunda ronda es informar un intervalo muy grande. Por ejemplo, el intervalo <span class="math inline">\([0,1]\)</span> está garantizado para incluir <span class="math inline">\(p\)</span>. Sin embargo, con un intervalo tan grande, no tenemos posibilidades de ganar la competencia. Del mismo modo, si usted es un pronosticador de elecciones y predice que el margen será entre -100% y 100%, será ridiculizado por decir lo obvio. Incluso un intervalo más pequeño, como decir que el diferencial estará entre -10 y 10%, no se considerará grave.</p>
<p>Por otro lado, cuanto menor es el intervalo que informamos, menores son nuestras posibilidades de ganar el premio. Del mismo modo, un encuestador audaz que informa intervalos muy pequeños y pierde la marca la mayor parte del tiempo no se considerará un buen encuestador. Queremos estar en algún punto intermedio.</p>
<p>Podemos usar la teoría estadística que hemos aprendido para calcular la probabilidad de cualquier intervalo dado, incluyendo <span class="math inline">\(p\)</span>. Si se nos pide que creemos un intervalo con, digamos, una probabilidad del 95% de incluir <span class="math inline">\(p\)</span>, podemos hacer eso también. Estos se denominan intervalos de confianza del 95%.</p>
<p>Cuando un encuestador informa una estimación y un margen de error, de alguna manera informa un intervalo de confianza del 95%. Vamos a mostrar cómo funciona esto matemáticamente.</p>
<p>Queremos saber la probabilidad de que el intervalo $ [{X} - 2({X}),{X} - 2({X})]$ contains the true proportion $ p $. Primero, considere que el inicio y el final de estos intervalos son variables aleatorias: cada vez que tomamos una muestra, cambian. Para ilustrar esto, ejecute la simulación Monte Carlo arriba dos veces. Usamos los mismos parámetros que arriba:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="fl">0.45</span>
N &lt;-<span class="st"> </span><span class="dv">1000</span></code></pre></div>
<p>Y observe que el intervalo aquí:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">size =</span> N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p))
x_hat &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
se_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(x_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x_hat)<span class="op">/</span><span class="st"> </span>N)
<span class="kw">c</span>(x_hat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se_hat, x_hat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se_hat)
<span class="co">#&gt; [1] 0.405 0.467</span></code></pre></div>
<p>es diferente de este:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">size=</span>N, <span class="dt">replace=</span><span class="ot">TRUE</span>, <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p))
x_hat &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
se_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(x_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x_hat)<span class="op">/</span><span class="st"> </span>N)
<span class="kw">c</span>(x_hat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se_hat, x_hat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se_hat)
<span class="co">#&gt; [1] 0.392 0.454</span></code></pre></div>
<p>Siga muestreando y creando intervalos y verá la variación aleatoria.</p>
<p>Para determinar la probabilidad de que el intervalo incluya <span class="math inline">\(p\)</span>, necesitamos calcular esto: <span class="math display">\[
\mbox{Pr}\left(\bar{X} - 1.96\hat{\mbox{SE}}(\bar{X})\leq p\leq\bar{X} + 1.96\hat{\mbox{SE}}(\bar{X})\right)
\]</span></p>
<p>Al restar y dividir las mismas cantidades en todas las partes de la ecuación, nosotros obtener que lo anterior es equivalente a:</p>
<p><span class="math display">\[
\mbox{Pr}\left(-1.96\leq\frac{\bar{X}- p}{\hat{\mbox{SE}}(\bar{X})}\leq 1.96\right)
\]</span></p>
<p>El término en el medio es una variable aleatoria aproximadamente normal con valor esperado 0 y error estándar 1, que hemos estado denotando con <span class="math inline">\(Z\)</span>, entonces tenemos:</p>
<p><span class="math display">\[
\mbox{Pr}\left(-1.96\leq Z\leq 1.96\right)
\]</span></p>
<p>que podemos calcular rápidamente usando:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="fl">1.96</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">1.96</span>)
<span class="co">#&gt; [1] 0.95</span></code></pre></div>
<p>demostrando que tenemos una probabilidad del 95%.</p>
<p>Si queremos tener una probabilidad mayor, digamos 99%, necesitamos multiplicar por lo que sea <code>z</code> cumple lo siguiente:</p>
<p><span class="math display">\[
\mbox{Pr}\left(-z\leq Z\leq z\right) = 0.99
\]</span></p>
<p>Utilizando:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.995</span>)
z
<span class="co">#&gt; [1] 2.58</span></code></pre></div>
<p>logrará esto porque por definición <code>pnorm(qnorm(0.995))</code> es 0.995 y por simetría <code>pnorm(1-qnorm(0.995))</code> es 1 - 0.995. Como consecuencia, tenemos que:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(z) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span>z)
<span class="co">#&gt; [1] 0.99</span></code></pre></div>
<p>es <code>0.995 - 0.005 = 0.99</code>. Podemos usar este enfoque para cualquier proporción <span class="math inline">\(p\)</span>: nosotros fijamos <code>z = qnorm(1 - (1 - p)/2)</code> porque <span class="math inline">\(1 - (1 - p)/2 + (1 - p)/2 = p\)</span>.</p>
<p>Entonces, por ejemplo, para <span class="math inline">\(p=0.95\)</span>, <span class="math inline">\(1 - (1-p)/2 = 0.975\)</span> y obtenemos el 1.96 que hemos estado usando:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(<span class="fl">0.975</span>)
<span class="co">#&gt; [1] 1.96</span></code></pre></div>
<div id="una-simulacion-de-monte-carlo-1" class="section level3">
<h3><span class="header-section-number">1.6.1</span> Una simulación de Monte Carlo</h3>
<p>Podemos ejecutar una simulación de Monte Carlo para confirmar que, de hecho, un intervalo de confianza del 95% incluye <span class="math inline">\(p\)</span> 95% del tiempo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">1000</span>
B &lt;-<span class="st"> </span><span class="dv">10000</span>
inside &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {
x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">size =</span> N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p))
x_hat &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
se_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(x_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x_hat)<span class="op">/</span><span class="st"> </span>N)
<span class="kw">between</span>(p, x_hat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se_hat, x_hat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se_hat)
})
<span class="kw">mean</span>(inside)
<span class="co">#&gt; [1] 0.948</span></code></pre></div>
<p>La siguiente gráfica muestra los primeros 100 intervalos de confianza. En este caso, creamos la simulación para que la línea negra denote el parámetro que estamos tratando de estimar:</p>
<p><img src="libro_files/figure-html/confidence-interval-coverage-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="el-idioma-correcto" class="section level3">
<h3><span class="header-section-number">1.6.2</span> El idioma correcto</h3>
<p>Al usar la teoría que describimos anteriormente, es importante recordar que son los intervalos los que son aleatorios, no <span class="math inline">\(p\)</span>. En la gráfica anterior, podemos ver los intervalos aleatorios moviéndose y <span class="math inline">\(p\)</span>, representado con la línea vertical, quedándose en el mismo lugar. La proporción de azul en la urna. <span class="math inline">\(p\)</span> no es. Entonces el 95% se relaciona con la probabilidad de que este intervalo aleatorio caiga por encima de <span class="math inline">\(p\)</span>. Diciendo el <span class="math inline">\(p\)</span> tiene una probabilidad del 95% de estar entre esto y eso es técnicamente una declaración incorrecta porque <span class="math inline">\(p\)</span> no es al azar.</p>
</div>
</div>
<div id="ejercicios-2" class="section level2">
<h2><span class="header-section-number">1.7</span> Ejercicios</h2>
<p>Para estos ejercicios, utilizaremos encuestas reales de las elecciones de 2016. Puede cargar los datos del paquete <strong>dslabs</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dslabs)
<span class="kw">data</span>(<span class="st">&quot;polls_us_election_2016&quot;</span>)</code></pre></div>
<p>Específicamente, utilizaremos todas las encuestas nacionales que finalizaron dentro de una semana antes de las elecciones.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
polls &lt;-<span class="st"> </span>polls_us_election_<span class="dv">2016</span> <span class="op">%&gt;%</span>
<span class="kw">filter</span>(enddate <span class="op">&gt;=</span><span class="st"> &quot;2016-10-31&quot;</span> <span class="op">&amp;</span><span class="st"> </span>state <span class="op">==</span><span class="st"> &quot;U.S.&quot;</span>)</code></pre></div>
<p>1. Para la primera encuesta, puede obtener el tamaño de las muestras y el porcentaje estimado de Clinton con:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span>polls<span class="op">$</span>samplesize[<span class="dv">1</span>]
x_hat &lt;-<span class="st"> </span>polls<span class="op">$</span>rawpoll_clinton[<span class="dv">1</span>]<span class="op">/</span><span class="dv">100</span></code></pre></div>
<p>Suponga que solo hay dos candidatos y construya un intervalo de confianza del 95% para la proporción de noche de elecciones <span class="math inline">\(p\)</span>.</p>
<p>2. Ahora usa <code>dplyr</code> para agregar un intervalo de confianza como dos columnas, llámelas <code>lower</code> y <code>upper</code>, al objeto <code>poll</code>. Luego usa <code>select</code> para mostrar el <code>pollster</code>, <code>enddate</code>, <code>x_hat</code>,<code>lower</code>, <code>upper</code> variables Sugerencia: defina columnas temporales <code>x_hat</code> y <code>se_hat</code>.</p>
<p>3. La cuenta final para el voto popular fue Clinton 48.2% y Trump 46.1%. Agrega una columna, llámalo <code>hit</code>, a la tabla anterior que indica si el intervalo de confianza incluía la proporción verdadera <span class="math inline">\(p=0.482\)</span> o no.</p>
<p>4. Para la tabla que acaba de crear, qué proporción de intervalos de confianza incluyó <span class="math inline">\(p\)</span>?</p>
<p>5. Si estos intervalos de confianza se construyen correctamente y la teoría se sostiene, qué proporción debería incluir <span class="math inline">\(p\)</span>?</p>
<p>6. Una proporción mucho menor de las encuestas de lo esperado produce intervalos de confianza que contienen <span class="math inline">\(p\)</span>. Si observa detenidamente la tabla, verá que la mayoría de las encuestas que no incluyen <span class="math inline">\(p\)</span> están subestimando. La razón de esto son los votantes indecisos, las personas encuestadas que aún no saben a quién votarán o no quieren decir. Debido a que, históricamente, los indecisos se dividen equitativamente entre los dos candidatos principales el día de las elecciones, es más informativo estimar la propagación o la diferencia entre la proporción de dos candidatos <span class="math inline">\(d\)</span>, que en esta elección fue <span class="math inline">\(0. 482 - 0.461 = 0.021\)</span>. Supongamos que solo hay dos partes y que <span class="math inline">\(d = 2p - 1\)</span>redefinir <code>polls</code> como abajo y vuelva a hacer el ejercicio 1, pero por la diferencia.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">polls &lt;-<span class="st"> </span>polls_us_election_<span class="dv">2016</span> <span class="op">%&gt;%</span>
<span class="kw">filter</span>(enddate <span class="op">&gt;=</span><span class="st"> &quot;2016-10-31&quot;</span> <span class="op">&amp;</span><span class="st"> </span>state <span class="op">==</span><span class="st"> &quot;U.S.&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">mutate</span>(<span class="dt">d_hat =</span> rawpoll_clinton<span class="op">/</span><span class="st"> </span><span class="dv">100</span> <span class="op">-</span><span class="st"> </span>rawpoll_trump<span class="op">/</span><span class="st"> </span><span class="dv">100</span>)</code></pre></div>
<p>7. Ahora repita el ejercicio 3, pero por la diferencia.</p>
<p>8. Ahora repita el ejercicio 4, pero por la diferencia.</p>
<p>9. Aunque la proporción de intervalos de confianza aumenta sustancialmente, sigue siendo inferior a 0,95. En el próximo capítulo, aprendemos la razón de esto. Para motivar esto, haga un diagrama del error, la diferencia entre la estimación de cada encuesta y la real <span class="math inline">\(d=0.021\)</span>. Estratificar por encuestador.</p>
<p>10. Vuelva a hacer la trama que hizo para el ejercicio 9, pero solo para los encuestadores que realizaron cinco o más encuestas.</p>
</div>
<div id="poder" class="section level2">
<h2><span class="header-section-number">1.8</span> Poder</h2>
<p>Los encuestadores no tienen éxito al proporcionar intervalos de confianza correctos, sino al predecir quién ganará. Cuando tomamos un tamaño de muestra de 25 cuentas, el intervalo de confianza para la propagación:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">25</span>
x_hat &lt;-<span class="st"> </span><span class="fl">0.48</span>
(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x_hat <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(x_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x_hat)<span class="op">/</span><span class="st"> </span>N)
<span class="co">#&gt; [1] -0.432  0.352</span></code></pre></div>
<p>incluye 0. Si esto fuera una encuesta y nos viéramos obligados a hacer una declaración, tendríamos que decir que fue un “lanzamiento”.</p>
<p>Un problema con los resultados de nuestra encuesta es que, dado el tamaño de la muestra y el valor de <span class="math inline">\(p\)</span>, tendríamos que sacrificar la probabilidad de una llamada incorrecta para crear un intervalo que no incluya 0.</p>
<p>Esto no significa que la elección esté cerrada. Solo significa que tenemos un tamaño de muestra pequeño. En los libros de texto estadísticos esto se llama falta de poder. En el contexto de las encuestas, <em>power</em> es la probabilidad de detectar spreads diferentes de 0.</p>
<p>Al aumentar el tamaño de nuestra muestra, disminuimos nuestro error estándar y, por lo tanto, tenemos muchas más posibilidades de detectar la dirección de la propagación.</p>
</div>
<div id="valores-p" class="section level2">
<h2><span class="header-section-number">1.9</span> valores p</h2>
<p>los valores p son ubicuos en la literatura científica. Están relacionados con los intervalos de confianza, por lo que presentamos el concepto aquí.</p>
<p>Consideremos las cuentas azules y rojas. Supongamos que, en lugar de querer una estimación de la propagación o la proporción de azul, solo me interesa la pregunta: ¿hay más cuentas azules o cuentas rojas? Quiero saber si la propagación <span class="math inline">\(2p-1 &gt; 0\)</span>.</p>
<p>Digamos que tomamos una muestra aleatoria de <span class="math inline">\(N=100\)</span> y observamos <span class="math inline">\(52\)</span> cuentas azules, lo que nos da $ 2{X}-1 = 0.04 $. Esto parece estar apuntando a la existencia de más cuentas azules que rojas ya que 0.04 es mayor que 0. Sin embargo, como científicos de datos, debemos ser escépticos. Sabemos que hay una posibilidad involucrada en este proceso y podríamos obtener un 52 incluso cuando el diferencial real sea 0. Llamamos a la suposición de que la propagación es <span class="math inline">\(2p-1=0\)</span> una hipótesis nula. La hipótesis nula es la hipótesis del escéptico. Hemos observado una variable aleatoria $ 2 *{X}-1 = 0.04 $ y el valor p es la respuesta a la pregunta: ¿qué tan probable es ver un valor tan grande, cuando la hipótesis nula es verdadera? Entonces escribimos:</p>
<p><span class="math display">\[\mbox{Pr}(\mid\bar{X} - 0.5\mid &gt; 0.02 ) \]</span></p>
<p>assuming the <span class="math inline">\(2p-1=0\)</span> or <span class="math inline">\(p=0.5\)</span>. Under the null hypothesis we know that:</p>
<p><span class="math display">\[
\sqrt {N}\frac {\bar{X} - 0.5}{\sqrt{0.5(1-0.5)}}
\]</span></p>
<p>is standard normal. We therefore can compute the probability above, which is the p-value.</p>
<p><span class="math display">\[\mbox{Pr}\left(\sqrt{N}\frac{\mid\bar{X} - 0.5\mid}{\sqrt{0.5(1-0.5)}} &gt;\sqrt{N}\frac{0.02}{\sqrt{0.5(1-0.5)}}\right)\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">100</span>
z &lt;-<span class="st"> </span><span class="kw">sqrt</span>(N)<span class="op">*</span><span class="fl">0.02</span><span class="op">/</span><span class="fl">0.5</span>
<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="kw">pnorm</span>(z) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span>z))
<span class="co">#&gt; [1] 0.689</span></code></pre></div>
<p>En este caso, existe una gran posibilidad de ver 52 o más bajo la hipótesis nula.</p>
<p>Tenga en cuenta que existe una estrecha conexión entre los valores p y los intervalos de confianza. Si un intervalo de confianza del 95% de la extensión no incluye 0, sabemos que el valor p debe ser menor que 0.05.</p>
<p>Para obtener más información sobre los valores p, puede consultar cualquier libro de texto de estadísticas. Sin embargo, en general, preferimos informar los intervalos de confianza sobre los valores p, ya que nos da una idea del tamaño de la estimación. Si solo informamos el valor p, no proporcionamos información sobre la importancia del hallazgo en el contexto del problema.</p>

</div>
<div id="association-tests" class="section level2">
<h2><span class="header-section-number">1.10</span> Pruebas de asociación</h2>
<p>Las pruebas estadísticas que hemos estudiado hasta ahora dejan de lado un porción sustancial de los tipos de datos. Específicamente, no hemos discutido la inferencia para datos binarios, categóricos y ordinales. Para dar un ejemplo muy específico, considere el siguiente estudio de caso.</p>
<p>Un documento de 2014 PNAS ^ [<a href="http://www.pnas.org/content/112/40/12349.abstract" class="uri">http://www.pnas.org/content/112/40/12349.abstract</a>] analizó las tasas de éxito de las agencias de financiación en los Países Bajos y concluyó que su:</p>
<blockquote>
<p>los resultados revelan un sesgo de género que favorece a los postulantes masculinos sobre las postulantes femeninas en la priorización de sus evaluaciones de “calidad de investigador” (pero no de “calidad de propuesta”) y en el uso del lenguaje en los materiales de instrucción y evaluación. La evidencia principal de esta conclusión se reduce a una comparación de los porcentajes. La Tabla S1 en el documento incluye la información que necesitamos. Aquí están las tres columnas que muestran los resultados generales:</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(dslabs)
<span class="kw">data</span>(<span class="st">&quot;research_funding_rates&quot;</span>)
research_funding_rates <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(discipline, applications_total,
success_rates_total) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()
<span class="co">#&gt;           discipline applications_total success_rates_total</span>
<span class="co">#&gt; 1  Chemical sciences                122                26.2</span>
<span class="co">#&gt; 2  Physical sciences                174                20.1</span>
<span class="co">#&gt; 3            Physics                 76                26.3</span>
<span class="co">#&gt; 4         Humanities                396                16.4</span>
<span class="co">#&gt; 5 Technical sciences                251                17.1</span>
<span class="co">#&gt; 6  Interdisciplinary                183                15.8</span></code></pre></div>
<p>Tenemos estos valores para cada género:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(research_funding_rates)
<span class="co">#&gt;  [1] &quot;discipline&quot;          &quot;applications_total&quot;  &quot;applications_men&quot;   </span>
<span class="co">#&gt;  [4] &quot;applications_women&quot;  &quot;awards_total&quot;        &quot;awards_men&quot;         </span>
<span class="co">#&gt;  [7] &quot;awards_women&quot;        &quot;success_rates_total&quot; &quot;success_rates_men&quot;  </span>
<span class="co">#&gt; [10] &quot;success_rates_women&quot;</span></code></pre></div>
<p>Podemos calcular los totales que tuvieron éxito y los totales que no fueron los siguientes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">totals &lt;-<span class="st"> </span>research_funding_rates <span class="op">%&gt;%</span>
<span class="kw">select</span>(<span class="op">-</span>discipline) <span class="op">%&gt;%</span>
<span class="kw">summarize_all</span>(sum) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">yes_men =</span> awards_men,
<span class="dt">no_men =</span> applications_men <span class="op">-</span><span class="st"> </span>awards_men,
<span class="dt">yes_women =</span> awards_women,
<span class="dt">no_women =</span> applications_women <span class="op">-</span><span class="st"> </span>awards_women)</code></pre></div>
<p>Entonces vemos que un mayor porcentaje de hombres que mujeres recibieron premios:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">totals <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">percent_men =</span> yes_men<span class="op">/</span>(yes_men<span class="op">+</span>no_men),
<span class="dt">percent_women =</span> yes_women<span class="op">/</span>(yes_women<span class="op">+</span>no_women))
<span class="co">#&gt;   percent_men percent_women</span>
<span class="co">#&gt; 1       0.177         0.149</span></code></pre></div>
<p>Pero, ¿podría esto deberse solo a la variabilidad aleatoria? Aquí aprendemos cómo realizar inferencia para este tipo de datos.</p>
<div id="lady-tasting-tea" class="section level3">
<h3><span class="header-section-number">1.10.1</span> Lady Tasting Tea</h3>
<p>RA Fisher ^ [<a href="https://en.wikipedia.org/wiki/Ronald_Fisher" class="uri">https://en.wikipedia.org/wiki/Ronald_Fisher</a>] fue uno de los primeros en formalizar la prueba de hipótesis. El “Lady Tasting Tea” es uno de los ejemplos más famosos.</p>
<p>La historia es la siguiente: un conocido de Fisher afirmó que ella podría decir si se agregó leche antes o después de que se vierte el té. Fisher se mostró escéptico. Diseñó un experimento para probar esta afirmación. Él le dio cuatro pares de tazas de té: una con leche vertida primero y la otra después. El orden fue aleatorizado La hipótesis nula aquí es que ella está adivinando. Fisher dedujo la distribución del número de selecciones correctas suponiendo que las elecciones fueron aleatorias e independientes.</p>
<p>Como ejemplo, supongamos que escogió 3 de 4 correctamente. Creemos ella tiene una habilidad especial? La pregunta básica que hacemos es: si el probador realmente está adivinando, ¿qué ¿son las posibilidades de que ella obtenga 3 o más correctas? Tal como lo hemos hecho antes, podemos calcular una probabilidad bajo la hipótesis nula de que ella está adivinando 4 de cada uno. Bajo esta hipótesis nula, podemos piense en este ejemplo particular como sacar 4 bolas de una urna con 4 bolas azules (respuesta correcta) y 4 rojas (respuesta incorrecta). Recuerde, ella sabe que hay cuatro antes del té y cuatro después.</p>
<p>Bajo la hipótesis nula de que ella simplemente está adivinando, cada bola tiene la misma posibilidad de ser elegido. Entonces podemos usar combinaciones para averiguar cada probabilidad. La probabilidad de elegir 3 es ${43} {41}/ {84} = 16/70 $. La probabilidad de escoger los 4 correctos es <span class="math inline">\({4\choose 4} {4\choose 0}/{8\choose 4}= 1/70\)</span>. Por lo tanto, la posibilidad de observar un 3 o algo más extremo, bajo la hipótesis nula, es <span class="math inline">\(\approx 0.24\)</span>. Este es el valor p. los el procedimiento que produjo este valor p se llama prueba exacta de pescador y utiliza la * distribución hipergeométrica *.</p>
</div>
<div id="tablas-de-dos-en-dos" class="section level3">
<h3><span class="header-section-number">1.10.2</span> Tablas de dos en dos</h3>
<p>Los datos del experimento generalmente se resumen en una tabla como esta:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">2</span>)
<span class="kw">rownames</span>(tab)&lt;-<span class="kw">c</span>(<span class="st">&quot;Poured Before&quot;</span>,<span class="st">&quot;Poured After&quot;</span>)
<span class="kw">colnames</span>(tab)&lt;-<span class="kw">c</span>(<span class="st">&quot;Guessed before&quot;</span>,<span class="st">&quot;Guessed after&quot;</span>)
tab
<span class="co">#&gt;               Guessed before Guessed after</span>
<span class="co">#&gt; Poured Before              3             1</span>
<span class="co">#&gt; Poured After               1             3</span></code></pre></div>
<p>Estos se conocen como una tabla de dos por dos. Para cada una de las cuatro combinaciones que se pueden obtener con un par de variables binarias, muestran los recuentos observados para cada ocurrencia.</p>
<p>La función <code>fisher.test</code> realiza los cálculos de inferencia anteriores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fisher.test</span>(tab, <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>)<span class="op">$</span>p.value
<span class="co">#&gt; [1] 0.243</span></code></pre></div>
</div>
<div id="prueba-de-chi-cuadrado" class="section level3">
<h3><span class="header-section-number">1.10.3</span> Prueba de chi-cuadrado</h3>
<p>Tenga en cuenta que, en cierto modo, nuestro ejemplo de tasas de financiación es similar al Lady Tasting Tea. Sin embargo, en el ejemplo de Lady Tasting Tea, el número de cuentas azules y rojas se fija experimentalmente y el número de respuestas dadas para cada categoría también. Esto se debe a que Fisher se aseguró de que se viertan cuatro tazas con leche antes del té y cuatro tazas con leche después y la señora lo sabía, por lo que las respuestas también tendrían que incluir cuatro antes y cuatro después. Si este es el caso, la suma de las filas y la suma de las columnas son fijas. Esto define restricciones sobre las posibles formas en que podemos llenar los dos por dos tablas y también nos permite usar el hipergeométrico distribución. En general, este no es el caso. No obstante, hay otro enfoque, la prueba de Chi-cuadrado, que se describe a continuación.</p>
<p>Imagina que tenemos 290, 1,345, 177, 1,011 solicitantes, algunos son hombres y otros son mujeres y algunos reciben financiación, mientras que otros no. Vimos que las tasas de éxito para hombres y mujeres fueron:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">totals <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">percent_men =</span> yes_men<span class="op">/</span>(yes_men<span class="op">+</span>no_men),
<span class="dt">percent_women =</span> yes_women<span class="op">/</span>(yes_women<span class="op">+</span>no_women))
<span class="co">#&gt;   percent_men percent_women</span>
<span class="co">#&gt; 1       0.177         0.149</span></code></pre></div>
<p>respectivamente. ¿Volveríamos a ver esto si asignamos fondos al azar a la tasa general?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rate &lt;-<span class="st"> </span>totals <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">percent_total =</span>
(yes_men <span class="op">+</span><span class="st"> </span>yes_women)<span class="op">/</span>
(yes_men <span class="op">+</span><span class="st"> </span>no_men <span class="op">+</span>yes_women <span class="op">+</span><span class="st"> </span>no_women)) <span class="op">%&gt;%</span>
<span class="kw">pull</span>(percent_total)
rate
<span class="co">#&gt; [1] 0.165</span></code></pre></div>
<p>La prueba de Chi-cuadrado responde a esta pregunta. El primer paso es crear la tabla de datos de dos por dos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">two_by_two &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">awarded =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>),
<span class="dt">men =</span> <span class="kw">c</span>(totals<span class="op">$</span>no_men, totals<span class="op">$</span>yes_men),
<span class="dt">women =</span> <span class="kw">c</span>(totals<span class="op">$</span>no_women, totals<span class="op">$</span>yes_women))
two_by_two
<span class="co">#&gt;   awarded  men women</span>
<span class="co">#&gt; 1      no 1345  1011</span>
<span class="co">#&gt; 2     yes  290   177</span></code></pre></div>
<p>La idea general de la prueba de Chi-cuadrado es comparar esta tabla de dos por dos con lo que espera ver, que sería:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data.frame</span>(<span class="dt">awarded =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>),
<span class="dt">men =</span> (totals<span class="op">$</span>no_men <span class="op">+</span><span class="st"> </span>totals<span class="op">$</span>yes_men) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rate, rate),
<span class="dt">women =</span> (totals<span class="op">$</span>no_women <span class="op">+</span><span class="st"> </span>totals<span class="op">$</span>yes_women) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rate, rate))
<span class="co">#&gt;   awarded  men women</span>
<span class="co">#&gt; 1      no 1365   991</span>
<span class="co">#&gt; 2     yes  270   197</span></code></pre></div>
<p>Podemos ver que más hombres de lo esperado y menos mujeres de lo esperado recibieron fondos. Sin embargo, bajo la hipótesis nula, estas observaciones son variables aleatorias. La prueba de Chi-cuadrado nos dice qué tan probable es ver una desviación tan grande o tan grande Esta prueba utiliza un resultado asintótico, similar al CLT, relacionado con las sumas de resultados binarios independientes. La función R <code>chisq.test</code> toma una tabla de dos por dos y devuelve los resultados de la prueba:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chisq_test &lt;-<span class="st"> </span>two_by_two <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>awarded) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">chisq.test</span>()</code></pre></div>
<p>Vemos que el valor p es 0.0509:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chisq_test<span class="op">$</span>p.value
<span class="co">#&gt; [1] 0.0509</span></code></pre></div>
</div>
<div id="odds-ratio" class="section level3">
<h3><span class="header-section-number">1.10.4</span> La razón de posibilidades</h3>
<p>Un resumen estadístico informativo asociado con tablas de dos por dos es la razón de posibilidades. Defina las dos variables como <span class="math inline">\(X = 1\)</span> si eres hombre y 0 de lo contrario, y <span class="math inline">\(Y=1\)</span> si está financiado y 0 de lo contrario. Las probabilidades de obtener fondos si eres hombre se definen:</p>
<p><span class="math display">\[\mbox{Pr}(Y=1\mid X=1)/\mbox{Pr}(Y=0\mid X=1)\]</span></p>
<p>and can be computed like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">odds_men &lt;-<span class="st"> </span><span class="kw">with</span>(two_by_two, (men[<span class="dv">2</span>]<span class="op">/</span><span class="kw">sum</span>(men))<span class="op">/</span><span class="st"> </span>(men[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(men)))
odds_men
<span class="co">#&gt; [1] 0.216</span></code></pre></div>
<p>And the odds of being funded if you are a woman is:</p>
<p><span class="math display">\[\mbox{Pr}(Y=1\mid X=0)/\mbox{Pr}(Y=0\mid X=0)\]</span></p>
<p>y se puede calcular así:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">odds_women &lt;-<span class="st"> </span><span class="kw">with</span>(two_by_two, (women[<span class="dv">2</span>]<span class="op">/</span><span class="kw">sum</span>(women))<span class="op">/</span><span class="st"> </span>(women[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(women)))
odds_women
<span class="co">#&gt; [1] 0.175</span></code></pre></div>
<p>La razón de probabilidades es la razón de estas dos probabilidades: ¿cuántas veces más grandes son las probabilidades para los hombres que para las mujeres?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">odds_men<span class="op">/</span><span class="st"> </span>odds_women
<span class="co">#&gt; [1] 1.23</span></code></pre></div>
<p>A menudo vemos tablas de dos por dos escritas como</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Men
</th>
<th style="text-align:center;">
Women
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Awarded
</td>
<td style="text-align:center;">
a
</td>
<td style="text-align:center;">
b
</td>
</tr>
<tr>
<td style="text-align:left;">
Not Awarded
</td>
<td style="text-align:center;">
c
</td>
<td style="text-align:center;">
d
</td>
</tr>
</tbody>
</table>
<p>En este caso, la razón de posibilidades es <span class="math inline">\(\frac {a/c} {b/d}\)</span> que es equivalente a <span class="math inline">\((ad)/ (bc)\)</span></p>
</div>
<div id="intervalos-de-confianza-para-la-razon-de-posibilidades" class="section level3">
<h3><span class="header-section-number">1.10.5</span> Intervalos de confianza para la razón de posibilidades</h3>
<p>Calcular intervalos de confianza para la razón de posibilidades no es matemáticamente sencillo. A diferencia de otras estadísticas, para las cuales podemos derivar aproximaciones útiles de sus distribuciones, la razón de probabilidades no es solo una relación, pero una relación de razones. Por lo tanto, no hay una forma simple de utilizando, por ejemplo, el CLT.</p>
<p>Sin embargo, la teoría estadística nos dice que cuando las cuatro entradas de la tabla de dos por dos son lo suficientemente grandes, entonces el registro de la razón de probabilidades es aproximadamente normal con error estándar</p>
<p><span class="math display">\[
\sqrt{1/a + 1/b + 1/c + 1/d}
\]</span></p>
<p>Esto implica que un intervalo de confianza del 95% para la relación de probabilidad logarítmica puede estar formado por:</p>
<p><span class="math display">\[
\log\left(\frac{ad}{bc}\right)\pm 1.96\sqrt{1/a + 1/b + 1/c + 1/d}
\]</span></p>
<p>Exponiendo estos dos números podemos construir un intervalo de confianza de la razón de posibilidades.</p>
<p>Usando R podemos calcular este intervalo de confianza de la siguiente manera:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log_or &lt;-<span class="st"> </span><span class="kw">log</span>(odds_men<span class="op">/</span><span class="st"> </span>odds_women)
se &lt;-<span class="st"> </span>two_by_two <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>awarded) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">se =</span> <span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="dv">1</span><span class="op">/</span>men) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(<span class="dv">1</span><span class="op">/</span>women))) <span class="op">%&gt;%</span>
<span class="kw">pull</span>(se)
ci &lt;-<span class="st"> </span>log_or <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span>se</code></pre></div>
<p>Si queremos convertirlo de nuevo a la escala de odds ratio, podemos exponer:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(ci)
<span class="co">#&gt; [1] 1.00 1.51</span></code></pre></div>
<p>Tenga en cuenta que 1 no está incluido en el intervalo de confianza, lo que debe significar que el valor p es menor que 0.05. Podemos confirmar esto usando:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(log_or, <span class="dv">0</span>, se))
<span class="co">#&gt; [1] 0.0454</span></code></pre></div>
<p>Este es un valor p ligeramente diferente al de la prueba de Chi-cuadrado. Esto se debe a que estamos utilizando una aproximación asintótica diferente a la distribución nula. Para obtener más información sobre la inferencia y la teoría asintótica de la razón de posibilidades, consulte el libro <em>Generalized Linear Models</em> de McCullagh y Nelder.</p>
</div>
<div id="correccion-de-recuento-pequeno" class="section level3">
<h3><span class="header-section-number">1.10.6</span> Corrección de recuento pequeño</h3>
<p>Tenga en cuenta que la razón de probabilidad logarítmica no está definida si alguna de las celdas de la tabla dos por dos es 0. Esto se debe a que si <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>o <span class="math inline">\(d\)</span> es 0, el $() $ es el logaritmo de 0 o tiene un 0 en el denominador. Para esta situación, es una práctica común evitar los 0 agregando 0.5 a cada celda. Esto se conoce como la corrección de Haldane-Anscombe y se ha demostrado, tanto en la práctica como en la teoría, que funciona bien.</p>
</div>
<div id="muestras-grandes-valores-p-pequenos" class="section level3">
<h3><span class="header-section-number">1.10.7</span> Muestras grandes, valores p pequeños</h3>
<p>Como se mencionó anteriormente, informar solo valores p no es apropiado forma de informar los resultados del análisis de datos. En revistas científicas, por ejemplo, algunos estudios parecen enfatizar demasiado los valores de p. Algunos de estos estudios tienen muestras de gran tamaño. e informar valores p impresionantemente pequeños. Sin embargo, cuando uno mira de cerca como resultado, nos damos cuenta de que los odds ratios son bastante modestos: apenas mayores que 1. En este caso, la diferencia puede no ser * prácticamente significativa * o * científicamente significativa *.</p>
<p>Tenga en cuenta que la relación entre odds ratio y valor p no es uno a uno. Depende del tamaño de la muestra. Por lo tanto, un valor p muy pequeño no necesariamente significa una razón de posibilidades muy grande. Observe qué sucede con el valor p si multiplicamos nuestra tabla de dos por dos por 10, lo que no cambia la razón de probabilidades:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">two_by_two <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>awarded) <span class="op">%&gt;%</span>
<span class="kw">mutate</span>(<span class="dt">men =</span> men<span class="op">*</span><span class="dv">10</span>, <span class="dt">women =</span> women<span class="op">*</span><span class="dv">10</span>) <span class="op">%&gt;%</span>
<span class="kw">chisq.test</span>() <span class="op">%&gt;%</span><span class="st"> </span>.<span class="op">$</span>p.value
<span class="co">#&gt; [1] 2.63e-10</span></code></pre></div>
</div>
</div>
<div id="ejercicios-3" class="section level2">
<h2><span class="header-section-number">1.11</span> Ejercicios</h2>
<p>1. Una atleta famosa tiene una carrera impresionante, ganando el 70% de sus 500 partidos de carrera. Sin embargo, esta atleta es criticada porque en eventos importantes, como los Juegos Olímpicos, tiene un récord perdedor de 8 victorias y 9 derrotas. Realice una prueba de Chi-cuadrado para determinar si este registro perdedor puede deberse simplemente al azar en lugar de no funcionar bien bajo presión.</p>
<p>2. ¿Por qué usamos la prueba de Chi-cuadrado en lugar de la prueba exacta de Fisher en el ejercicio anterior?</p>
<ol style="list-style-type: lower-alpha">
<li>En realidad no importa, ya que dan exactamente el mismo valor p. si. La exacta de Fisher y el Chi-cuadrado son nombres diferentes para la misma prueba.</li>
<li>Debido a que la suma de las filas y columnas de la tabla de dos por dos no son fijas, la distribución hipergeométrica no es una suposición apropiada para la hipótesis nula. Por esta razón, la prueba exacta de Fisher rara vez es aplicable con datos de observación. re. Porque la prueba de Chi-cuadrado se ejecuta más rápido.</li>
</ol>
<p>3. Calcule la razón de posibilidades de “perder bajo presión” junto con un intervalo de confianza.</p>
<p>4. Observe que el valor p es mayor que 0.05 pero el intervalo de confianza del 95% no incluye 1. ¿Qué explica esto?</p>
<ol style="list-style-type: lower-alpha">
<li>Cometimos un error en nuestro código. si. Estas no son pruebas t, por lo que no se aplica la conexión entre el valor p y los intervalos de confianza.</li>
<li>Se utilizan diferentes aproximaciones para el valor p y el cálculo del intervalo de confianza. Si tuviéramos un tamaño de muestra más grande, la coincidencia sería mejor. re. Deberíamos usar la prueba exacta de Fisher para obtener intervalos de confianza.</li>
</ol>
<p>5. Multiplique la tabla dos por dos por 2 y vea si el valor p y la recuperación de confianza coinciden mejor.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="models.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["libro.pdf", "libro.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
