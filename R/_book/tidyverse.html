<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-basics.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Comenzando con R y RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#por-que-r"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué R?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#la-consola-r"><i class="fa fa-check"></i><b>1.2</b> La consola R</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#guiones"><i class="fa fa-check"></i><b>1.3</b> Guiones</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#rstudio"><i class="fa fa-check"></i><b>1.4</b> RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="getting-started.html"><a href="getting-started.html#los-paneles"><i class="fa fa-check"></i><b>1.4.1</b> Los paneles</a></li>
<li class="chapter" data-level="1.4.2" data-path="getting-started.html"><a href="getting-started.html#atajos-de-teclado"><i class="fa fa-check"></i><b>1.4.2</b> Atajos de teclado</a></li>
<li class="chapter" data-level="1.4.3" data-path="getting-started.html"><a href="getting-started.html#ejecutando-comandos-mientras-edita-scripts"><i class="fa fa-check"></i><b>1.4.3</b> Ejecutando comandos mientras edita scripts</a></li>
<li class="chapter" data-level="1.4.4" data-path="getting-started.html"><a href="getting-started.html#cambio-de-opciones-globales"><i class="fa fa-check"></i><b>1.4.4</b> Cambio de opciones globales</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#instalacion-de-paquetes-r"><i class="fa fa-check"></i><b>1.5</b> Instalación de paquetes R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>2</b> Importando datos</a><ul>
<li class="chapter" data-level="2.1" data-path="importing-data.html"><a href="importing-data.html#rutas-y-el-directorio-de-trabajo"><i class="fa fa-check"></i><b>2.1</b> Rutas y el directorio de trabajo</a><ul>
<li class="chapter" data-level="2.1.1" data-path="importing-data.html"><a href="importing-data.html#el-sistema-de-archivos"><i class="fa fa-check"></i><b>2.1.1</b> El sistema de archivos</a></li>
<li class="chapter" data-level="2.1.2" data-path="importing-data.html"><a href="importing-data.html#caminos-relativos-y-completos"><i class="fa fa-check"></i><b>2.1.2</b> Caminos relativos y completos</a></li>
<li class="chapter" data-level="2.1.3" data-path="importing-data.html"><a href="importing-data.html#el-directorio-de-trabajo"><i class="fa fa-check"></i><b>2.1.3</b> El directorio de trabajo</a></li>
<li class="chapter" data-level="2.1.4" data-path="importing-data.html"><a href="importing-data.html#generando-nombres-de-ruta"><i class="fa fa-check"></i><b>2.1.4</b> Generando nombres de ruta</a></li>
<li class="chapter" data-level="2.1.5" data-path="importing-data.html"><a href="importing-data.html#copiando-archivos-usando-rutas"><i class="fa fa-check"></i><b>2.1.5</b> Copiando archivos usando rutas</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="importing-data.html"><a href="importing-data.html#los-paquetes-readr-y-readxl"><i class="fa fa-check"></i><b>2.2</b> Los paquetes readr y readxl</a><ul>
<li class="chapter" data-level="2.2.1" data-path="importing-data.html"><a href="importing-data.html#lector"><i class="fa fa-check"></i><b>2.2.1</b> lector</a></li>
<li class="chapter" data-level="2.2.2" data-path="importing-data.html"><a href="importing-data.html#readxl"><i class="fa fa-check"></i><b>2.2.2</b> readxl</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="importing-data.html"><a href="importing-data.html#ejercicios"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="importing-data.html"><a href="importing-data.html#descargando-archivos"><i class="fa fa-check"></i><b>2.4</b> Descargando archivos</a></li>
<li class="chapter" data-level="2.5" data-path="importing-data.html"><a href="importing-data.html#funciones-de-importacion-de-base-r"><i class="fa fa-check"></i><b>2.5</b> Funciones de importación de base R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="importing-data.html"><a href="importing-data.html#scan"><i class="fa fa-check"></i><b>2.5.1</b> <code>scan</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="importing-data.html"><a href="importing-data.html#texto-versus-archivos-binarios"><i class="fa fa-check"></i><b>2.6</b> Texto versus archivos binarios</a></li>
<li class="chapter" data-level="2.7" data-path="importing-data.html"><a href="importing-data.html#unicode-versus-ascii"><i class="fa fa-check"></i><b>2.7</b> Unicode versus ASCII</a></li>
<li class="chapter" data-level="2.8" data-path="importing-data.html"><a href="importing-data.html#organizando-datos-con-hojas-de-calculo"><i class="fa fa-check"></i><b>2.8</b> Organizando datos con hojas de cálculo</a></li>
<li class="chapter" data-level="2.9" data-path="importing-data.html"><a href="importing-data.html#ejercicios-1"><i class="fa fa-check"></i><b>2.9</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="installing-r-rstudio.html"><a href="installing-r-rstudio.html"><i class="fa fa-check"></i><b>3</b> Instalación de R y RStudio</a><ul>
<li class="chapter" data-level="3.1" data-path="installing-r-rstudio.html"><a href="installing-r-rstudio.html#instalando-r"><i class="fa fa-check"></i><b>3.1</b> Instalando R</a></li>
<li class="chapter" data-level="3.2" data-path="installing-r-rstudio.html"><a href="installing-r-rstudio.html#instalacion-de-rstudio"><i class="fa fa-check"></i><b>3.2</b> Instalación de RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="conceptos-basicos-de-programacion.html"><a href="conceptos-basicos-de-programacion.html"><i class="fa fa-check"></i><b>4</b> Conceptos básicos de programación</a><ul>
<li class="chapter" data-level="4.1" data-path="conceptos-basicos-de-programacion.html"><a href="conceptos-basicos-de-programacion.html#conditionals"><i class="fa fa-check"></i><b>4.1</b> Expresiones condicionales</a></li>
<li class="chapter" data-level="4.2" data-path="conceptos-basicos-de-programacion.html"><a href="conceptos-basicos-de-programacion.html#definiendo-funciones"><i class="fa fa-check"></i><b>4.2</b> Definiendo funciones</a></li>
<li class="chapter" data-level="4.3" data-path="conceptos-basicos-de-programacion.html"><a href="conceptos-basicos-de-programacion.html#espacios-de-nombres"><i class="fa fa-check"></i><b>4.3</b> Espacios de nombres</a></li>
<li class="chapter" data-level="4.4" data-path="conceptos-basicos-de-programacion.html"><a href="conceptos-basicos-de-programacion.html#for-loops"><i class="fa fa-check"></i><b>4.4</b> For-loops</a></li>
<li class="chapter" data-level="4.5" data-path="conceptos-basicos-de-programacion.html"><a href="conceptos-basicos-de-programacion.html#vectorization"><i class="fa fa-check"></i><b>4.5</b> Vectorización y funcionales</a></li>
<li class="chapter" data-level="4.6" data-path="conceptos-basicos-de-programacion.html"><a href="conceptos-basicos-de-programacion.html#ejercicios-2"><i class="fa fa-check"></i><b>4.6</b> Ejercicios</a></li>
</ul></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="5" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>5</b> R básicos</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basics.html"><a href="r-basics.html#estudio-de-caso-asesinatos-de-armas"><i class="fa fa-check"></i><b>5.1</b> Estudio de caso: asesinatos de armas</a></li>
<li class="chapter" data-level="5.2" data-path="r-basics.html"><a href="r-basics.html#los-muy-basicos"><i class="fa fa-check"></i><b>5.2</b> Los muy básicos</a><ul>
<li class="chapter" data-level="5.2.1" data-path="r-basics.html"><a href="r-basics.html#objetos"><i class="fa fa-check"></i><b>5.2.1</b> Objetos</a></li>
<li class="chapter" data-level="5.2.2" data-path="r-basics.html"><a href="r-basics.html#el-espacio-de-trabajo"><i class="fa fa-check"></i><b>5.2.2</b> El espacio de trabajo</a></li>
<li class="chapter" data-level="5.2.3" data-path="r-basics.html"><a href="r-basics.html#funciones"><i class="fa fa-check"></i><b>5.2.3</b> Funciones</a></li>
<li class="chapter" data-level="5.2.4" data-path="r-basics.html"><a href="r-basics.html#otros-objetos-preconstruidos"><i class="fa fa-check"></i><b>5.2.4</b> Otros objetos preconstruidos</a></li>
<li class="chapter" data-level="5.2.5" data-path="r-basics.html"><a href="r-basics.html#nombres-de-variables"><i class="fa fa-check"></i><b>5.2.5</b> Nombres de variables</a></li>
<li class="chapter" data-level="5.2.6" data-path="r-basics.html"><a href="r-basics.html#guardar-su-espacio-de-trabajo"><i class="fa fa-check"></i><b>5.2.6</b> Guardar su espacio de trabajo</a></li>
<li class="chapter" data-level="5.2.7" data-path="r-basics.html"><a href="r-basics.html#scripts-motivadores"><i class="fa fa-check"></i><b>5.2.7</b> Scripts motivadores</a></li>
<li class="chapter" data-level="5.2.8" data-path="r-basics.html"><a href="r-basics.html#comentando-tu-codigo"><i class="fa fa-check"></i><b>5.2.8</b> Comentando tu código</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="r-basics.html"><a href="r-basics.html#ejercicios-3"><i class="fa fa-check"></i><b>5.3</b> Ejercicios</a></li>
<li class="chapter" data-level="5.4" data-path="r-basics.html"><a href="r-basics.html#tipos-de-datos"><i class="fa fa-check"></i><b>5.4</b> Tipos de datos</a><ul>
<li class="chapter" data-level="5.4.1" data-path="r-basics.html"><a href="r-basics.html#data-frames"><i class="fa fa-check"></i><b>5.4.1</b> Marcos de datos</a></li>
<li class="chapter" data-level="5.4.2" data-path="r-basics.html"><a href="r-basics.html#examinando-un-objeto"><i class="fa fa-check"></i><b>5.4.2</b> Examinando un objeto</a></li>
<li class="chapter" data-level="5.4.3" data-path="r-basics.html"><a href="r-basics.html#el-descriptor-de-acceso"><i class="fa fa-check"></i><b>5.4.3</b> El descriptor de acceso: <code>$</code></a></li>
<li class="chapter" data-level="5.4.4" data-path="r-basics.html"><a href="r-basics.html#vectores-numericos-caracteres-y-logicos"><i class="fa fa-check"></i><b>5.4.4</b> Vectores: numéricos, caracteres y lógicos</a></li>
<li class="chapter" data-level="5.4.5" data-path="r-basics.html"><a href="r-basics.html#factors"><i class="fa fa-check"></i><b>5.4.5</b> Factores</a></li>
<li class="chapter" data-level="5.4.6" data-path="r-basics.html"><a href="r-basics.html#listas"><i class="fa fa-check"></i><b>5.4.6</b> Listas</a></li>
<li class="chapter" data-level="5.4.7" data-path="r-basics.html"><a href="r-basics.html#matrices"><i class="fa fa-check"></i><b>5.4.7</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="r-basics.html"><a href="r-basics.html#ejercicios-4"><i class="fa fa-check"></i><b>5.5</b> Ejercicios</a></li>
<li class="chapter" data-level="5.6" data-path="r-basics.html"><a href="r-basics.html#vectores"><i class="fa fa-check"></i><b>5.6</b> Vectores</a><ul>
<li class="chapter" data-level="5.6.1" data-path="r-basics.html"><a href="r-basics.html#crear-vectores"><i class="fa fa-check"></i><b>5.6.1</b> Crear vectores</a></li>
<li class="chapter" data-level="5.6.2" data-path="r-basics.html"><a href="r-basics.html#nombres"><i class="fa fa-check"></i><b>5.6.2</b> Nombres</a></li>
<li class="chapter" data-level="5.6.3" data-path="r-basics.html"><a href="r-basics.html#secuencias"><i class="fa fa-check"></i><b>5.6.3</b> Secuencias</a></li>
<li class="chapter" data-level="5.6.4" data-path="r-basics.html"><a href="r-basics.html#subconjunto"><i class="fa fa-check"></i><b>5.6.4</b> Subconjunto</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="r-basics.html"><a href="r-basics.html#coercion"><i class="fa fa-check"></i><b>5.7</b> Coerción</a><ul>
<li class="chapter" data-level="5.7.1" data-path="r-basics.html"><a href="r-basics.html#no-disponible-na"><i class="fa fa-check"></i><b>5.7.1</b> No disponible (NA)</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="r-basics.html"><a href="r-basics.html#ejercicios-5"><i class="fa fa-check"></i><b>5.8</b> Ejercicios</a></li>
<li class="chapter" data-level="5.9" data-path="r-basics.html"><a href="r-basics.html#clasificacion"><i class="fa fa-check"></i><b>5.9</b> Clasificación</a><ul>
<li class="chapter" data-level="5.9.1" data-path="r-basics.html"><a href="r-basics.html#sort"><i class="fa fa-check"></i><b>5.9.1</b> <code>sort</code></a></li>
<li class="chapter" data-level="5.9.2" data-path="r-basics.html"><a href="r-basics.html#order"><i class="fa fa-check"></i><b>5.9.2</b> <code>order</code></a></li>
<li class="chapter" data-level="5.9.3" data-path="r-basics.html"><a href="r-basics.html#max-y-which.max"><i class="fa fa-check"></i><b>5.9.3</b> <code>max</code> y <code>which.max</code></a></li>
<li class="chapter" data-level="5.9.4" data-path="r-basics.html"><a href="r-basics.html#rank"><i class="fa fa-check"></i><b>5.9.4</b> <code>rank</code></a></li>
<li class="chapter" data-level="5.9.5" data-path="r-basics.html"><a href="r-basics.html#cuidado-con-el-reciclaje"><i class="fa fa-check"></i><b>5.9.5</b> Cuidado con el reciclaje</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="r-basics.html"><a href="r-basics.html#ejercicios-6"><i class="fa fa-check"></i><b>5.10</b> Ejercicios</a></li>
<li class="chapter" data-level="5.11" data-path="r-basics.html"><a href="r-basics.html#aritmetica-de-vectores"><i class="fa fa-check"></i><b>5.11</b> Aritmética de vectores</a><ul>
<li class="chapter" data-level="5.11.1" data-path="r-basics.html"><a href="r-basics.html#reescalando-un-vector"><i class="fa fa-check"></i><b>5.11.1</b> Reescalando un vector</a></li>
<li class="chapter" data-level="5.11.2" data-path="r-basics.html"><a href="r-basics.html#dos-vectores"><i class="fa fa-check"></i><b>5.11.2</b> Dos vectores</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="r-basics.html"><a href="r-basics.html#ejercicios-7"><i class="fa fa-check"></i><b>5.12</b> Ejercicios</a></li>
<li class="chapter" data-level="5.13" data-path="r-basics.html"><a href="r-basics.html#indexacion"><i class="fa fa-check"></i><b>5.13</b> Indexación</a><ul>
<li class="chapter" data-level="5.13.1" data-path="r-basics.html"><a href="r-basics.html#subconjunto-con-logicas"><i class="fa fa-check"></i><b>5.13.1</b> Subconjunto con lógicas</a></li>
<li class="chapter" data-level="5.13.2" data-path="r-basics.html"><a href="r-basics.html#operadores-logicos"><i class="fa fa-check"></i><b>5.13.2</b> Operadores logicos</a></li>
<li class="chapter" data-level="5.13.3" data-path="r-basics.html"><a href="r-basics.html#which"><i class="fa fa-check"></i><b>5.13.3</b> <code>which</code></a></li>
<li class="chapter" data-level="5.13.4" data-path="r-basics.html"><a href="r-basics.html#match"><i class="fa fa-check"></i><b>5.13.4</b> <code>match</code></a></li>
<li class="chapter" data-level="5.13.5" data-path="r-basics.html"><a href="r-basics.html#in"><i class="fa fa-check"></i><b>5.13.5</b> <code>%in%</code></a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="r-basics.html"><a href="r-basics.html#ejercicios-8"><i class="fa fa-check"></i><b>5.14</b> Ejercicios</a></li>
<li class="chapter" data-level="5.15" data-path="r-basics.html"><a href="r-basics.html#parcelas-basicas"><i class="fa fa-check"></i><b>5.15</b> Parcelas básicas</a><ul>
<li class="chapter" data-level="5.15.1" data-path="r-basics.html"><a href="r-basics.html#plot"><i class="fa fa-check"></i><b>5.15.1</b> <code>plot</code></a></li>
<li class="chapter" data-level="5.15.2" data-path="r-basics.html"><a href="r-basics.html#hist"><i class="fa fa-check"></i><b>5.15.2</b> <code>hist</code></a></li>
<li class="chapter" data-level="5.15.3" data-path="r-basics.html"><a href="r-basics.html#boxplot"><i class="fa fa-check"></i><b>5.15.3</b> <code>boxplot</code></a></li>
<li class="chapter" data-level="5.15.4" data-path="r-basics.html"><a href="r-basics.html#image"><i class="fa fa-check"></i><b>5.15.4</b> <code>image</code></a></li>
</ul></li>
<li class="chapter" data-level="5.16" data-path="r-basics.html"><a href="r-basics.html#ejercicios-9"><i class="fa fa-check"></i><b>5.16</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>6</b> El tidyverse</a><ul>
<li class="chapter" data-level="6.1" data-path="tidyverse.html"><a href="tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>6.1</b> Datos ordenados</a></li>
<li class="chapter" data-level="6.2" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-10"><i class="fa fa-check"></i><b>6.2</b> Ejercicios</a></li>
<li class="chapter" data-level="6.3" data-path="tidyverse.html"><a href="tidyverse.html#manipulacion-de-marcos-de-datos"><i class="fa fa-check"></i><b>6.3</b> Manipulación de marcos de datos</a><ul>
<li class="chapter" data-level="6.3.1" data-path="tidyverse.html"><a href="tidyverse.html#agregar-una-columna-con-mutate"><i class="fa fa-check"></i><b>6.3.1</b> Agregar una columna con <code>mutate</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="tidyverse.html"><a href="tidyverse.html#subconjunto-con-filter"><i class="fa fa-check"></i><b>6.3.2</b> Subconjunto con <code>filter</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="tidyverse.html"><a href="tidyverse.html#seleccionar-columnas-con-select"><i class="fa fa-check"></i><b>6.3.3</b> Seleccionar columnas con <code>select</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-11"><i class="fa fa-check"></i><b>6.4</b> Ejercicios</a></li>
<li class="chapter" data-level="6.5" data-path="tidyverse.html"><a href="tidyverse.html#el-tubo"><i class="fa fa-check"></i><b>6.5</b> El tubo: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="6.6" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-12"><i class="fa fa-check"></i><b>6.6</b> Ejercicios</a></li>
<li class="chapter" data-level="6.7" data-path="tidyverse.html"><a href="tidyverse.html#resumiendo-datos"><i class="fa fa-check"></i><b>6.7</b> Resumiendo datos</a><ul>
<li class="chapter" data-level="6.7.1" data-path="tidyverse.html"><a href="tidyverse.html#summarize"><i class="fa fa-check"></i><b>6.7.1</b> <code>summarize</code></a></li>
<li class="chapter" data-level="6.7.2" data-path="tidyverse.html"><a href="tidyverse.html#pull"><i class="fa fa-check"></i><b>6.7.2</b> <code>pull</code></a></li>
<li class="chapter" data-level="6.7.3" data-path="tidyverse.html"><a href="tidyverse.html#group-by"><i class="fa fa-check"></i><b>6.7.3</b> Agrupe y luego resuma con <code>group_by</code></a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="tidyverse.html"><a href="tidyverse.html#ordenar-marcos-de-datos"><i class="fa fa-check"></i><b>6.8</b> Ordenar marcos de datos</a><ul>
<li class="chapter" data-level="6.8.1" data-path="tidyverse.html"><a href="tidyverse.html#clasificacion-anidada"><i class="fa fa-check"></i><b>6.8.1</b> Clasificación anidada</a></li>
<li class="chapter" data-level="6.8.2" data-path="tidyverse.html"><a href="tidyverse.html#la-parte-superior-n"><i class="fa fa-check"></i><b>6.8.2</b> La parte superior <span class="math inline">\(n\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-13"><i class="fa fa-check"></i><b>6.9</b> Ejercicios</a></li>
<li class="chapter" data-level="6.10" data-path="tidyverse.html"><a href="tidyverse.html#tibbles"><i class="fa fa-check"></i><b>6.10</b> Tibbles</a><ul>
<li class="chapter" data-level="6.10.1" data-path="tidyverse.html"><a href="tidyverse.html#tibbles-se-muestran-mejor"><i class="fa fa-check"></i><b>6.10.1</b> Tibbles se muestran mejor</a></li>
<li class="chapter" data-level="6.10.2" data-path="tidyverse.html"><a href="tidyverse.html#los-subconjuntos-de-tibbles-son-tibbles"><i class="fa fa-check"></i><b>6.10.2</b> Los subconjuntos de tibbles son tibbles</a></li>
<li class="chapter" data-level="6.10.3" data-path="tidyverse.html"><a href="tidyverse.html#tibbles-puede-tener-entradas-complejas"><i class="fa fa-check"></i><b>6.10.3</b> Tibbles puede tener entradas complejas</a></li>
<li class="chapter" data-level="6.10.4" data-path="tidyverse.html"><a href="tidyverse.html#tibbles-se-pueden-agrupar"><i class="fa fa-check"></i><b>6.10.4</b> Tibbles se pueden agrupar</a></li>
<li class="chapter" data-level="6.10.5" data-path="tidyverse.html"><a href="tidyverse.html#crear-un-tibble-usando-tibble-en-lugar-de-data.frame"><i class="fa fa-check"></i><b>6.10.5</b> Crear un tibble usando <code>tibble</code> en lugar de <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="tidyverse.html"><a href="tidyverse.html#el-operador-punto"><i class="fa fa-check"></i><b>6.11</b> El operador punto</a></li>
<li class="chapter" data-level="6.12" data-path="tidyverse.html"><a href="tidyverse.html#do"><i class="fa fa-check"></i><b>6.12</b> <code>do</code></a></li>
<li class="chapter" data-level="6.13" data-path="tidyverse.html"><a href="tidyverse.html#el-paquete-purrr"><i class="fa fa-check"></i><b>6.13</b> El paquete <strong>purrr</strong></a></li>
<li class="chapter" data-level="6.14" data-path="tidyverse.html"><a href="tidyverse.html#tidyverse-condicionales"><i class="fa fa-check"></i><b>6.14</b> Tidyverse condicionales</a><ul>
<li class="chapter" data-level="6.14.1" data-path="tidyverse.html"><a href="tidyverse.html#case_when"><i class="fa fa-check"></i><b>6.14.1</b> <code>case_when</code></a></li>
<li class="chapter" data-level="6.14.2" data-path="tidyverse.html"><a href="tidyverse.html#between"><i class="fa fa-check"></i><b>6.14.2</b> <code>between</code></a></li>
</ul></li>
<li class="chapter" data-level="6.15" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-14"><i class="fa fa-check"></i><b>6.15</b> Ejercicios</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1">
<h1><span class="header-section-number">6</span> El tidyverse</h1>
<p>Hasta ahora hemos estado manipulando vectores reordenándolos y subconjuntándolos mediante indexación. Sin embargo, una vez que comenzamos los análisis más avanzados, la unidad preferida para el almacenamiento de datos no es el vector sino el marco de datos. En este capítulo aprendemos a trabajar directamente con marcos de datos, que facilitan enormemente la organización de la información. Utilizaremos marcos de datos para la mayoría de este libro. Nos centraremos en un formato de datos específico denominado <em>tidy_y en una colección específica de paquetes que son particularmente útiles para trabajar con_tidy_datos denominados_tidyverse</em>.</p>
<p>Podemos cargar todos los paquetes tidyverse a la vez instalando y cargando el paquete <strong>tidyverse</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p>Aprenderemos cómo implementar el enfoque tidyverse a lo largo del libro, pero antes de profundizar en los detalles, en este capítulo presentamos algunas de las funciones tidyverse más utilizadas, comenzando con el paquete __dplyr__para manipular marcos de datos y el paquete<strong>purrr</strong> para trabajar con funciones Tenga en cuenta que tidyverse también incluye un paquete de gráficos, <strong>ggplot2</strong>, que presentaremos más adelante en el Capítulo <a href="#ggplot2"><strong>??</strong></a> en la parte de visualización de datos del libro; el paquete <strong>readr</strong> discutido en el Capítulo <a href="importing-data.html#importing-data">2</a>; y muchos otros. En este capítulo, primero presentamos el concepto de <em>tidy data</em> y luego demostramos cómo usamos el tidyverse para trabajar con marcos de datos en este formato.</p>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">6.1</span> Datos ordenados</h2>
<p>Decimos que una tabla de datos está en formato <em>tidy</em> si cada fila representa una observación y las columnas representan las diferentes variables disponibles para cada una de estas observaciones. los <code>murders</code> el conjunto de datos es un ejemplo de un marco de datos ordenado.</p>
<pre><code>##        state abb region population total
## 1    Alabama  AL  South    4779736   135
## 2     Alaska  AK   West     710231    19
## 3    Arizona  AZ   West    6392017   232
## 4   Arkansas  AR  South    2915918    93
## 5 California  CA   West   37253956  1257
## 6   Colorado  CO   West    5029196    65</code></pre>
<p>Cada fila representa un estado con cada una de las cinco columnas que proporcionan una variable diferente relacionada con estos estados: nombre, abreviatura, región, población y asesinatos totales.</p>
<p>Para ver cómo se puede proporcionar la misma información en diferentes formatos, considere el siguiente ejemplo:</p>
<pre><code>##       country year fertility
## 1     Germany 1960      2.41
## 2 South Korea 1960      6.16
## 3     Germany 1961      2.44
## 4 South Korea 1961      5.99
## 5     Germany 1962      2.47
## 6 South Korea 1962      5.79</code></pre>
<p>Este conjunto de datos ordenado proporciona tasas de fertilidad para dos países a lo largo de los años. Este es un conjunto de datos ordenado porque cada fila presenta una observación con las tres variables: país, año y tasa de fecundidad. Sin embargo, este conjunto de datos originalmente vino en otro formato y se reformó para el paquete <strong>dslabs</strong>. Originalmente, los datos estaban en el siguiente formato:</p>
<pre><code>##       country 1960 1961 1962
## 1     Germany 2.41 2.44 2.47
## 2 South Korea 6.16 5.99 5.79</code></pre>
<p>Se proporciona la misma información, pero hay dos diferencias importantes en el formato: 1) cada fila incluye varias observaciones y 2) una de las variables, año, se almacena en el encabezado. Para que los paquetes tidyverse se utilicen de manera óptima, los datos deben ser reformados en <code>tidy</code> formato, que aprenderá a hacer en la parte del Libro de disputas de datos. Hasta entonces, utilizaremos conjuntos de datos de ejemplo que ya están en formato ordenado.</p>
<p>Aunque no es inmediatamente obvio, a medida que avance en el libro comenzará a apreciar las ventajas de trabajar en un marco en el que las funciones usan formatos ordenados tanto para las entradas como para las salidas. Verá cómo esto permite que el analista de datos se centre en aspectos más importantes del análisis en lugar del formato de los datos.</p>
</div>
<div id="ejercicios-10" class="section level2">
<h2><span class="header-section-number">6.2</span> Ejercicios</h2>
<p>1. Examinar el conjunto de datos incorporado. <code>co2</code>. Cual de los siguientes es verdadero:</p>
<ol style="list-style-type: lower-alpha">
<li><code>co2</code> son datos ordenados: tiene un año para cada fila. si. <code>co2</code> no es ordenado: necesitamos al menos una columna con un vector de caracteres.</li>
<li><code>co2</code> no es ordenado: es una matriz en lugar de un marco de datos. re. <code>co2</code> no es ordenado: para ser ordenado tendríamos que arreglarlo para tener tres columnas (año, mes y valor), luego cada observación de CO2 tendría una fila.</li>
</ol>
<p>2. Examinar el conjunto de datos incorporado. <code>ChickWeight</code>. Cual de los siguientes es verdadero:</p>
<ol style="list-style-type: lower-alpha">
<li><code>ChickWeight</code> no está ordenado: cada pollito tiene más de una fila. si. <code>ChickWeight</code> es ordenado: cada observación (un peso) está representada por una fila. La chica de la que provino esta medición es una de las variables.</li>
<li><code>ChickWeight</code> no está ordenado: nos falta la columna del año. re. <code>ChickWeight</code> es ordenado: se almacena en un marco de datos.</li>
</ol>
<p>3. Examinar el conjunto de datos incorporado. <code>BOD</code>. Cual de los siguientes es verdadero:</p>
<ol style="list-style-type: lower-alpha">
<li><code>BOD</code> no está ordenado: solo tiene seis filas. si. <code>BOD</code> no es ordenado: la primera columna es solo un índice.</li>
<li><code>BOD</code> es ordenado: cada fila es una observación con dos valores (tiempo y demanda) re. <code>BOD</code> es ordenado: todos los conjuntos de datos pequeños son ordenados por definición.</li>
</ol>
<p>4. ¿Cuál de los siguientes conjuntos de datos integrados está ordenado (puede elegir más de uno):</p>
<ol style="list-style-type: lower-alpha">
<li><code>BJsales</code> si. <code>EuStockMarkets</code> re. <code>DNase</code> re. <code>Formaldehyde</code></li>
</ol>
<ol start="1001" style="list-style-type: lower-roman">
<li><code>Orange</code></li>
</ol>
<ol start="6" style="list-style-type: lower-alpha">
<li><code>UCBAdmissions</code></li>
</ol>
</div>
<div id="manipulacion-de-marcos-de-datos" class="section level2">
<h2><span class="header-section-number">6.3</span> Manipulación de marcos de datos</h2>
<p>El paquete __dplyr__del<strong>tidyverse</strong> introduce funciones que realizan algunas de las operaciones más comunes cuando se trabaja con marcos de datos y usa nombres para estas funciones que son relativamente fáciles de recordar. Por ejemplo, para cambiar la tabla de datos agregando una nueva columna, utilizamos <code>mutate</code>. Para filtrar la tabla de datos a un subconjunto de filas, utilizamos <code>filter</code>. Finalmente, para subdividir los datos seleccionando columnas específicas, usamos <code>select</code>.</p>
<div id="agregar-una-columna-con-mutate" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Agregar una columna con <code>mutate</code></h3>
<p>Queremos que toda la información necesaria para nuestro análisis se incluya en la tabla de datos. Entonces, la primera tarea es agregar las tasas de asesinatos a nuestro marco de datos de asesinatos. La función <code>mutate</code> toma el marco de datos como primer argumento y el nombre y los valores de la variable como segundo argumento usando la convención <code>name = values</code>. Entonces, para agregar tasas de asesinatos, usamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dslabs)
<span class="kw">data</span>(<span class="st">&quot;murders&quot;</span>)
murders &lt;-<span class="st"> </span><span class="kw">mutate</span>(murders, <span class="dt">rate =</span> total<span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>)</code></pre></div>
<p>Tenga en cuenta que aquí usamos <code>total</code> y <code>population</code> dentro de la función, que son objetos <strong>no</strong> definidos en nuestro espacio de trabajo. Pero, ¿por qué no recibimos un error?</p>
<p>Esta es una de las principales características de <strong>dplyr</strong>. Funciones en este paquete, como <code>mutate</code>, sepa buscar variables en el marco de datos proporcionado en el primer argumento. En la llamada a mutar arriba, <code>total</code> tendrá los valores en <code>murders$total</code>. Este enfoque hace que el código sea mucho más legible.</p>
<p>Podemos ver que se agrega la nueva columna:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(murders)</code></pre></div>
<pre><code>##        state abb region population total rate
## 1    Alabama  AL  South    4779736   135 2.82
## 2     Alaska  AK   West     710231    19 2.68
## 3    Arizona  AZ   West    6392017   232 3.63
## 4   Arkansas  AR  South    2915918    93 3.19
## 5 California  CA   West   37253956  1257 3.37
## 6   Colorado  CO   West    5029196    65 1.29</code></pre>
<p>Aunque hemos sobrescrito el original <code>murders</code> objeto, esto no cambia el objeto que se cargó con <code>data(murders)</code>. Si cargamos el <code>murders</code> nuevamente, el original sobrescribirá nuestra versión mutada.</p>
</div>
<div id="subconjunto-con-filter" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Subconjunto con <code>filter</code></h3>
<p>Ahora suponga que queremos filtrar la tabla de datos para mostrar solo las entradas para las que la tasa de homicidios es inferior a 0,71. Para hacer esto usamos el <code>filter</code> función, que toma la tabla de datos como primer argumento y luego la declaración condicional como el segundo. Me gusta <code>mutate</code>, podemos usar los nombres de variables sin comillas de <code>murders</code> dentro de la función y sabrá que nos referimos a las columnas y no a los objetos en el espacio de trabajo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(murders, rate <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.71</span>)</code></pre></div>
<pre><code>##           state abb        region population total  rate
## 1        Hawaii  HI          West    1360301     7 0.515
## 2          Iowa  IA North Central    3046355    21 0.689
## 3 New Hampshire  NH     Northeast    1316470     5 0.380
## 4  North Dakota  ND North Central     672591     4 0.595
## 5       Vermont  VT     Northeast     625741     2 0.320</code></pre>
</div>
<div id="seleccionar-columnas-con-select" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Seleccionar columnas con <code>select</code></h3>
<p>Aunque nuestra tabla de datos solo tiene seis columnas, algunas tablas de datos incluyen cientos. Si queremos ver solo algunos, podemos usar el <strong>dplyr</strong> <code>select</code> función. En el siguiente código seleccionamos tres columnas, asignamos esto a un nuevo objeto y luego filtramos el nuevo objeto:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_table &lt;-<span class="st"> </span><span class="kw">select</span>(murders, state, region, rate)
<span class="kw">filter</span>(new_table, rate <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.71</span>)</code></pre></div>
<pre><code>##           state        region  rate
## 1        Hawaii          West 0.515
## 2          Iowa North Central 0.689
## 3 New Hampshire     Northeast 0.380
## 4  North Dakota North Central 0.595
## 5       Vermont     Northeast 0.320</code></pre>
<p>En la llamada a <code>select</code>, el primer argumento <code>murders</code> es un objeto, pero <code>state</code>, <code>region</code> y <code>rate</code> son nombres de variables</p>
</div>
</div>
<div id="ejercicios-11" class="section level2">
<h2><span class="header-section-number">6.4</span> Ejercicios</h2>
<p>1. Cargue el paquete <strong>dplyr</strong> y el conjunto de datos de asesinatos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(dslabs)
<span class="kw">data</span>(murders)</code></pre></div>
<p>Puede agregar columnas usando la función <strong>dplyr</strong> <code>mutate</code>. Esta función conoce los nombres de columna y dentro de la función puede llamarlos sin comillas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders &lt;-<span class="st"> </span><span class="kw">mutate</span>(murders, <span class="dt">population_in_millions =</span> population<span class="op">/</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)</code></pre></div>
<p>Podemos escribir <code>population</code> más bien que <code>murders$population</code>. La función <code>mutate</code> sabe que estamos agarrando columnas de <code>murders</code>.</p>
<p>Usa la función <code>mutate</code> para agregar una columna de asesinatos llamada <code>rate</code> con la tasa de asesinatos por 100,000 como en el código de ejemplo anterior. Asegúrate de redefinir <code>murders</code> como se hizo en el código de ejemplo anterior (asesinatos &lt;- [su código]) para que podamos seguir usando esta variable.</p>
<p>2. Si <code>rank(x)</code> te da las filas de <code>x</code> de menor a mayor, <code>rank(-x)</code> te da los rangos de mayor a menor. Usa la función <code>mutate</code> para agregar una columna <code>rank</code> que contiene el rango, de mayor a menor índice de asesinatos. Asegúrate de redefinir <code>murders</code> para que podamos seguir usando esta variable.</p>
<p>3. Con <strong>dplyr</strong>, podemos usar <code>select</code> para mostrar solo ciertas columnas. Por ejemplo, con este código solo mostraríamos los estados y los tamaños de población:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(murders, state, population) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</code></pre></div>
<p>Utilizar <code>select</code> para mostrar los nombres de estado y abreviaturas en <code>murders</code>. No redefinir <code>murders</code>, solo muestra los resultados.</p>
<p>4. La función <strong>dplyr</strong> <code>filter</code> se utiliza para elegir filas específicas del marco de datos para mantener. diferente a <code>select</code> que es para columnas, <code>filter</code> es para filas Por ejemplo, puede mostrar solo la fila de Nueva York de esta manera:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(murders, state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>)</code></pre></div>
<p>Puede usar otros vectores lógicos para filtrar filas.</p>
<p>Utilizar <code>filter</code> para mostrar los 5 principales estados con las tasas de asesinatos más altas. Después de agregar la tasa y rango de asesinatos, no cambie el conjunto de datos de asesinatos, solo muestre el resultado. Recuerde que puede filtrar en función de <code>rank</code> columna.</p>
<p>5. Podemos eliminar filas usando el <code>!=</code> operador. Por ejemplo, para eliminar Florida, haríamos esto:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">no_florida &lt;-<span class="st"> </span><span class="kw">filter</span>(murders, state <span class="op">!=</span><span class="st"> &quot;Florida&quot;</span>)</code></pre></div>
<p>Crear un nuevo marco de datos llamado <code>no_south</code> que elimina estados de la región sur. ¿Cuántos estados hay en esta categoría? Puedes usar la función <code>nrow</code> para esto.</p>
<p>6. También podemos usar <code>%in%</code> para filtrar con <strong>dplyr</strong>. Por lo tanto, puede ver los datos de Nueva York y Texas de esta manera:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(murders, state <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;New York&quot;</span>, <span class="st">&quot;Texas&quot;</span>))</code></pre></div>
<p>Crear un nuevo marco de datos llamado <code>murders_nw</code> con solo los estados del noreste y oeste. ¿Cuántos estados hay en esta categoría?</p>
<p>7. Suponga que desea vivir en el noreste u oeste <strong>y</strong> desea que la tasa de homicidios sea inferior a 1. Queremos ver los datos de los estados que satisfacen estas opciones. Tenga en cuenta que puede usar operadores lógicos con <code>filter</code>. Aquí hay un ejemplo en el que filtramos para mantener solo estados pequeños en la región noreste.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(murders, population <span class="op">&lt;</span><span class="st"> </span><span class="dv">5000000</span> <span class="op">&amp;</span><span class="st"> </span>region <span class="op">==</span><span class="st"> &quot;Northeast&quot;</span>)</code></pre></div>
<p>Asegurarse <code>murders</code> ha sido definido con <code>rate</code> y <code>rank</code> y todavía tiene todos los estados. Crea una tabla llamada <code>my_states</code> que contiene filas para estados que satisfacen ambas condiciones: está en el noreste u oeste y la tasa de homicidios es inferior a 1. Use <code>select</code> para mostrar solo el nombre del estado, la tasa y el rango.</p>
</div>
<div id="el-tubo" class="section level2">
<h2><span class="header-section-number">6.5</span> El tubo: <code>%&gt;%</code></h2>
<p>Con <strong>dplyr</strong> podemos realizar una serie de operaciones, por ejemplo <code>select</code> y entonces <code>filter</code>, enviando los resultados de una función a otra usando lo que se llama <em>pipe operator</em>: <code>%&gt;%</code>. Algunos detalles se incluyen a continuación.</p>
<p>Escribimos el código anterior para mostrar tres variables (estado, región, tasa) para los estados que tienen tasas de asesinatos por debajo de 0,71. Para hacer esto, definimos el objeto intermedio <code>new_table</code>. En <strong>dplyr</strong> podemos escribir código que se parezca más a una descripción de lo que queremos hacer sin objetos intermedios:</p>
<p><span class="math display">\[ \mbox {original data }
\rightarrow \mbox { select }
\rightarrow \mbox { filter } \]</span></p>
<p>Para tal operación, podemos usar la tubería <code>%&gt;%</code>. El código se ve así:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(state, region, rate) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(rate <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.71</span>)</code></pre></div>
<pre><code>##           state        region  rate
## 1        Hawaii          West 0.515
## 2          Iowa North Central 0.689
## 3 New Hampshire     Northeast 0.380
## 4  North Dakota North Central 0.595
## 5       Vermont     Northeast 0.320</code></pre>
<p>Esta línea de código es equivalente a las dos líneas de código anteriores. ¿Que esta pasando aqui?</p>
<p>En general, la tubería envía el resultado del lado izquierdo de la tubería como el primer argumento de la función en el lado derecho de la tubería. Aquí hay un ejemplo muy simple:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">16</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Podemos continuar canalizando valores a lo largo de:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">16</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log2</span>()</code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>La declaración anterior es equivalente a <code>log2(sqrt(16))</code>.</p>
<p>Recuerde que la tubería envía valores al primer argumento, por lo que podemos definir otros argumentos como si el primer argumento ya estuviera definido:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">16</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log</span>(<span class="dt">base =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Por lo tanto, al usar la tubería con marcos de datos y <strong>dplyr</strong>, ya no necesitamos especificar el primer argumento requerido ya que las funciones <strong>dplyr</strong> que hemos descrito toman todos los datos como el primer argumento. En el código que escribimos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(state, region, rate) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(rate <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.71</span>)</code></pre></div>
<p><code>murders</code> es el primer argumento de la <code>select</code> función, y el nuevo marco de datos (anteriormente <code>new_table</code>) es el primer argumento de la <code>filter</code> función.</p>
<p>Tenga en cuenta que la tubería funciona bien con funciones donde el primer argumento son los datos de entrada. Las funciones en los paquetes __tidyverse__como<strong>dplyr</strong> tienen este formato y se pueden usar fácilmente con la tubería.</p>
</div>
<div id="ejercicios-12" class="section level2">
<h2><span class="header-section-number">6.6</span> Ejercicios</h2>
<p>1. El tubo <code>%&gt;%</code> se puede usar para realizar operaciones secuencialmente sin tener que definir objetos intermedios. Comience redefiniendo el asesinato para incluir la tasa y el rango.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders &lt;-<span class="st"> </span><span class="kw">mutate</span>(murders, <span class="dt">rate =</span> total<span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>,
<span class="dt">rank =</span> <span class="kw">rank</span>(<span class="op">-</span>rate))</code></pre></div>
<p>En la solución al ejercicio anterior, hicimos lo siguiente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_states &lt;-<span class="st"> </span><span class="kw">filter</span>(murders, region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;West&quot;</span>) <span class="op">&amp;</span>
rate <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)

<span class="kw">select</span>(my_states, state, rate, rank)</code></pre></div>
<p>El tubo <code>%&gt;%</code> nos permite realizar ambas operaciones secuencialmente sin tener que definir una variable intermedia <code>my_states</code>. Por lo tanto, podríamos haber mutado y seleccionado en la misma línea de esta manera:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mutate</span>(murders, <span class="dt">rate =</span> total<span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>,
<span class="dt">rank =</span> <span class="kw">rank</span>(<span class="op">-</span>rate)) <span class="op">%&gt;%</span>
<span class="kw">select</span>(state, rate, rank)</code></pre></div>
<p>Darse cuenta de <code>select</code> ya no tiene un marco de datos como primer argumento. Se supone que el primer argumento es el resultado de la operación realizada justo antes de <code>%&gt;%</code>.</p>
<p>Repita el ejercicio anterior, pero ahora, en lugar de crear un nuevo objeto, muestre el resultado y solo incluya las columnas de estado, velocidad y rango. Usar una pipa <code>%&gt;%</code> para hacer esto en una sola línea.</p>
<p>2. Reiniciar <code>murders</code> a la tabla original usando <code>data(murders)</code>. Use una tubería para crear un nuevo marco de datos llamado <code>my_states</code> que considera solo los estados del noreste u oeste que tienen una tasa de homicidios inferior a 1 y contiene solo las columnas de estado, tasa y rango. La tubería también debe tener cuatro componentes separados por tres <code>%&gt;%</code>. El código debería verse así:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_states &lt;-<span class="st"> </span>murders <span class="op">%&gt;%</span>
mutate SOMETHING <span class="op">%&gt;%</span>
filter SOMETHING <span class="op">%&gt;%</span>
select SOMETHING</code></pre></div>
</div>
<div id="resumiendo-datos" class="section level2">
<h2><span class="header-section-number">6.7</span> Resumiendo datos</h2>
<p>Una parte importante del análisis exploratorio de datos es resumir los datos. La desviación promedio y estándar son dos ejemplos de estadísticas de resumen ampliamente utilizadas. A menudo se pueden obtener resúmenes más informativos dividiendo primero los datos en grupos. En esta sección, cubrimos dos nuevos verbos <strong>dplyr</strong> que facilitan estos cálculos: <code>summarize</code> y <code>group_by</code>. Aprendemos a acceder a los valores resultantes utilizando el <code>pull</code> función.</p>
<div id="summarize" class="section level3">
<h3><span class="header-section-number">6.7.1</span> <code>summarize</code></h3>
<p>Los <code>summarize</code> la función <strong>dplyr</strong> proporciona una forma de calcular estadísticas de resumen con código intuitivo y legible. Comenzamos con un ejemplo simple basado en alturas. los <code>heights</code> el conjunto de datos incluye las alturas y el sexo reportado por los estudiantes en una encuesta en clase.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(dslabs)
<span class="kw">data</span>(heights)</code></pre></div>
<p>El siguiente código calcula la desviación promedio y estándar para las mujeres:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span>heights <span class="op">%&gt;%</span>
<span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;Female&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">average =</span> <span class="kw">mean</span>(height), <span class="dt">standard_deviation =</span> <span class="kw">sd</span>(height))
s</code></pre></div>
<pre><code>##   average standard_deviation
## 1    64.9               3.76</code></pre>
<p>Esto toma nuestra tabla de datos original como entrada, la filtra para mantener solo a las mujeres y luego produce una nueva tabla resumida con solo el promedio y la desviación estándar de las alturas. Podemos elegir los nombres de las columnas de la tabla resultante. Por ejemplo, arriba decidimos usar <code>average</code> y <code>standard_deviation</code>, pero podríamos haber usado otros nombres de la misma manera.</p>
<p>Porque la tabla resultante almacenada en <code>s</code> es un marco de datos, podemos acceder a los componentes con el descriptor de acceso <code>$</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s<span class="op">$</span>average</code></pre></div>
<pre><code>## [1] 64.9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s<span class="op">$</span>standard_deviation</code></pre></div>
<pre><code>## [1] 3.76</code></pre>
<p>Como con la mayoría de las otras funciones <strong>dplyr</strong>, <code>summarize</code> conoce los nombres de las variables y podemos usarlos directamente. Entonces, dentro de la llamada al <code>summarize</code> función que escribimos <code>mean(height)</code>, la función accede a la columna con el nombre “altura” y luego calcula el promedio del vector numérico resultante. Podemos calcular cualquier otro resumen que opera en vectores y devuelve un solo valor. Por ejemplo, podemos agregar las alturas mediana, mínima y máxima de esta manera:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span>
<span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;Female&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">median =</span> <span class="kw">median</span>(height), <span class="dt">minimum =</span> <span class="kw">min</span>(height),
<span class="dt">maximum =</span> <span class="kw">max</span>(height))</code></pre></div>
<pre><code>##   median minimum maximum
## 1     65      51      79</code></pre>
<p>Podemos obtener estos tres valores con solo una línea usando el <code>quantile</code> función: por ejemplo, <code>quantile(x, c(0,0.5,1))</code> devuelve el mínimo (percentil 0), la mediana (percentil 50) y el máximo (percentil 100) del vector <code>x</code>. Sin embargo, si intentamos usar una función como esta que devuelve dos o más valores dentro <code>summarize</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span>
<span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;Female&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">range =</span> <span class="kw">quantile</span>(height, <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)))</code></pre></div>
<p>recibiremos un error: <code>Error: expecting result of length one, got : 2</code>. Con la función <code>summarize</code>, solo podemos llamar a funciones que devuelven un solo valor. En la sección <a href="tidyverse.html#do">6.12</a>, aprenderemos cómo lidiar con funciones que devuelven más de un valor.</p>
<p>Para otro ejemplo de cómo podemos usar el <code>summarize</code> función, calculemos la tasa promedio de asesinatos en los Estados Unidos. Recuerde que nuestra tabla de datos incluye asesinatos totales y el tamaño de la población para cada estado y ya hemos usado <strong>dplyr</strong> para agregar una columna de índice de asesinatos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders &lt;-<span class="st"> </span>murders <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">rate =</span> total<span class="op">/</span>population<span class="op">*</span><span class="dv">100000</span>)</code></pre></div>
<p>Recuerde que la tasa de asesinatos en EE. UU. Es <strong>no</strong> el promedio de las tasas de asesinatos estatales:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summarize</span>(murders, <span class="kw">mean</span>(rate))</code></pre></div>
<pre><code>##   mean(rate)
## 1       2.78</code></pre>
<p>Esto se debe a que en el cálculo anterior, los estados pequeños tienen el mismo peso que los grandes. La tasa de homicidios en los Estados Unidos es el número total de asesinatos en los Estados Unidos dividido por la población total de los Estados Unidos. Entonces el cálculo correcto es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">us_murder_rate &lt;-<span class="st"> </span>murders <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">rate =</span> <span class="kw">sum</span>(total)<span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(population) <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>)
us_murder_rate</code></pre></div>
<pre><code>##   rate
## 1 3.03</code></pre>
<p>Este cálculo cuenta estados más grandes proporcionalmente a su tamaño, lo que da como resultado un valor mayor.</p>
</div>
<div id="pull" class="section level3">
<h3><span class="header-section-number">6.7.2</span> <code>pull</code></h3>
<p>Los <code>us_murder_rate</code> el objeto definido anteriormente representa solo un número. Sin embargo, lo estamos almacenando en un marco de datos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(us_murder_rate)</code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>ya que, como la mayoría de las funciones <strong>dplyr</strong>, <code>summarize</code> siempre devuelve un marco de datos.</p>
<p>Esto podría ser problemático si queremos usar este resultado con funciones que requieren un valor numérico. Aquí mostramos un truco útil para acceder a los valores almacenados en los datos cuando se usan tuberías: cuando un objeto de datos se canaliza a ese objeto y se puede acceder a sus columnas usando el <code>pull</code> función. Para entender lo que queremos decir, eche un vistazo a esta línea de código:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">us_murder_rate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(rate)</code></pre></div>
<pre><code>## [1] 3.03</code></pre>
<p>Esto devuelve el valor en el <code>rate</code> columna de <code>us_murder_rate</code> haciéndolo equivalente a <code>us_murder_rate$rate</code>.</p>
<p>Para obtener un número de la tabla de datos original con una línea de código, podemos escribir:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">us_murder_rate &lt;-<span class="st"> </span>murders <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">rate =</span> <span class="kw">sum</span>(total)<span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(population) <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>) <span class="op">%&gt;%</span>
<span class="kw">pull</span>(rate)

us_murder_rate</code></pre></div>
<pre><code>## [1] 3.03</code></pre>
<p>que ahora es numérico:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(us_murder_rate)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
</div>
<div id="group-by" class="section level3">
<h3><span class="header-section-number">6.7.3</span> Agrupe y luego resuma con <code>group_by</code></h3>
<p>Una operación común en la exploración de datos es dividir primero los datos en grupos y luego calcular resúmenes para cada grupo. Por ejemplo, podemos querer calcular la desviación promedio y estándar para las alturas de hombres y mujeres por separado. los <code>group_by</code> la función nos ayuda a hacer esto.</p>
<p>Si escribimos esto:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sex)</code></pre></div>
<pre><code>## # A tibble: 1,050 x 2
## # Groups:   sex [2]
##   sex   height
##   &lt;fct&gt;  &lt;dbl&gt;
## 1 Male      75
## 2 Male      70
## 3 Male      68
## 4 Male      74
## 5 Male      61
## # … with 1,045 more rows</code></pre>
<p>El resultado no se ve muy diferente de <code>heights</code>, excepto que vemos <code>Groups: sex [2]</code> cuando imprimimos el objeto. Aunque no es inmediatamente obvio por su apariencia, ahora es un marco de datos especial llamado _marco de datos agrupados_y funciones<strong>dplyr</strong>, en particular <code>summarize</code>, se comportará de manera diferente cuando actúe sobre este objeto. Conceptualmente, puede pensar en esta tabla como muchas tablas, con las mismas columnas pero no necesariamente el mismo número de filas, apiladas juntas en un objeto. Cuando resumimos los datos después de la agrupación, esto es lo que sucede:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span>
<span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">average =</span> <span class="kw">mean</span>(height), <span class="dt">standard_deviation =</span> <span class="kw">sd</span>(height))</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   sex    average standard_deviation
##   &lt;fct&gt;    &lt;dbl&gt;              &lt;dbl&gt;
## 1 Female    64.9               3.76
## 2 Male      69.3               3.61</code></pre>
<p>Los <code>summarize</code> la función aplica el resumen a cada grupo por separado.</p>
<p>Para otro ejemplo, calculemos la tasa media de asesinatos en las cuatro regiones del país:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span>
<span class="kw">group_by</span>(region) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">median_rate =</span> <span class="kw">median</span>(rate))</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   region        median_rate
##   &lt;fct&gt;               &lt;dbl&gt;
## 1 Northeast            1.80
## 2 South                3.40
## 3 North Central        1.97
## 4 West                 1.29</code></pre>
</div>
</div>
<div id="ordenar-marcos-de-datos" class="section level2">
<h2><span class="header-section-number">6.8</span> Ordenar marcos de datos</h2>
<p>Al examinar un conjunto de datos, a menudo es conveniente ordenar la tabla por las diferentes columnas. Sabemos sobre el <code>order</code> y <code>sort</code> función, pero para ordenar tablas enteras, la función <strong>dplyr</strong> <code>arrange</code> es útil. Por ejemplo, aquí ordenamos los estados por tamaño de población:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span>
<span class="kw">arrange</span>(population) <span class="op">%&gt;%</span>
<span class="kw">head</span>()</code></pre></div>
<pre><code>##                  state abb        region population total   rate
## 1              Wyoming  WY          West     563626     5  0.887
## 2 District of Columbia  DC         South     601723    99 16.453
## 3              Vermont  VT     Northeast     625741     2  0.320
## 4         North Dakota  ND North Central     672591     4  0.595
## 5               Alaska  AK          West     710231    19  2.675
## 6         South Dakota  SD North Central     814180     8  0.983</code></pre>
<p>Con <code>arrange</code> podemos decidir por qué columna ordenar. Para ver los estados por población, de menor a mayor, organizamos por <code>rate</code> en lugar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span>
<span class="kw">arrange</span>(rate) <span class="op">%&gt;%</span>
<span class="kw">head</span>()</code></pre></div>
<pre><code>##           state abb        region population total  rate
## 1       Vermont  VT     Northeast     625741     2 0.320
## 2 New Hampshire  NH     Northeast    1316470     5 0.380
## 3        Hawaii  HI          West    1360301     7 0.515
## 4  North Dakota  ND North Central     672591     4 0.595
## 5          Iowa  IA North Central    3046355    21 0.689
## 6         Idaho  ID          West    1567582    12 0.766</code></pre>
<p>Tenga en cuenta que el comportamiento predeterminado es ordenar en orden ascendente. En <strong>dplyr</strong>, la función <code>desc</code> transforma un vector para que esté en orden descendente. Para ordenar la tabla en orden descendente, podemos escribir:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span>
<span class="kw">arrange</span>(<span class="kw">desc</span>(rate))</code></pre></div>
<div id="clasificacion-anidada" class="section level3">
<h3><span class="header-section-number">6.8.1</span> Clasificación anidada</h3>
<p>Si estamos ordenando por una columna con empates, podemos usar una segunda columna para romper el empate. Del mismo modo, se puede usar una tercera columna para romper los lazos entre la primera y la segunda, y así sucesivamente. Aquí ordenamos por <code>region</code>, luego dentro de la región ordenamos por índice de asesinatos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span>
<span class="kw">arrange</span>(region, rate) <span class="op">%&gt;%</span>
<span class="kw">head</span>()</code></pre></div>
<pre><code>##           state abb    region population total  rate
## 1       Vermont  VT Northeast     625741     2 0.320
## 2 New Hampshire  NH Northeast    1316470     5 0.380
## 3         Maine  ME Northeast    1328361    11 0.828
## 4  Rhode Island  RI Northeast    1052567    16 1.520
## 5 Massachusetts  MA Northeast    6547629   118 1.802
## 6      New York  NY Northeast   19378102   517 2.668</code></pre>
</div>
<div id="la-parte-superior-n" class="section level3">
<h3><span class="header-section-number">6.8.2</span> La parte superior <span class="math inline">\(n\)</span></h3>
<p>En el código anterior, hemos usado la función <code>head</code> para evitar que la página se llene con todo el conjunto de datos. Si queremos ver una mayor proporción, podemos usar el <code>top_n</code> función. Esta función toma un marco de datos como primer argumento, el número de filas para mostrar en el segundo y la variable para filtrar en el tercero. Aquí hay un ejemplo de cómo ver las 5 filas superiores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">5</span>, rate)</code></pre></div>
<pre><code>##                  state abb        region population total  rate
## 1 District of Columbia  DC         South     601723    99 16.45
## 2            Louisiana  LA         South    4533372   351  7.74
## 3             Maryland  MD         South    5773552   293  5.07
## 4             Missouri  MO North Central    5988927   321  5.36
## 5       South Carolina  SC         South    4625364   207  4.48</code></pre>
<p>Tenga en cuenta que las filas no están ordenadas por <code>rate</code>, solo filtrado. Si queremos ordenar, necesitamos usar <code>arrange</code>. Tenga en cuenta que si el tercer argumento se deja en blanco, <code>top_n</code>, filtra por la última columna.</p>
</div>
</div>
<div id="ejercicios-13" class="section level2">
<h2><span class="header-section-number">6.9</span> Ejercicios</h2>
<p>Para estos ejercicios, utilizaremos los datos de la encuesta recopilada por el Centro Nacional de Estadísticas de Salud de los Estados Unidos (NCHS). Este centro ha realizado una serie de encuestas de salud y nutrición desde la década de 1960. A partir de 1999, alrededor de 5,000 individuos de todas las edades han sido entrevistados cada año y completan el componente de examen de salud de la encuesta. Parte de los datos está disponible a través del paquete <strong>NHANES</strong>. Una vez que instale el paquete <strong>NHANES</strong>, puede cargar los datos de esta manera:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(NHANES)
<span class="kw">data</span>(NHANES)</code></pre></div>
<p>Los datos <strong>NHANES</strong> tienen muchos valores faltantes. Recuerde que la función de resumen principal en R devolverá <code>NA</code> si alguna de las entradas del vector de entrada es un <code>NA</code>. Aquí hay un ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dslabs)
<span class="kw">data</span>(na_example)
<span class="kw">mean</span>(na_example)</code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(na_example)</code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Ignorar el <code>NA</code> s podemos usar el <code>na.rm</code> argumento:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(na_example, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 2.3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(na_example, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 1.22</code></pre>
<p>Exploremos ahora los datos de NHANES.</p>
<p>1. Le proporcionaremos algunos datos básicos sobre la presión arterial. Primero, seleccionemos un grupo para establecer el estándar. Utilizaremos hembras de 20 a 29 años. <code>AgeDecade</code> es una variable categórica con estas edades. Tenga en cuenta que la categoría está codificada como “20-29”, ¡con un espacio al frente! ¿Cuál es la desviación promedio y estándar de la presión arterial sistólica como se guarda en el <code>BPSysAve</code> ¿variable? Guárdelo en una variable llamada <code>ref</code>.</p>
<p>Sugerencia: uso <code>filter</code> y <code>summarize</code> y usa el <code>na.rm = TRUE</code> argumento al calcular el promedio y la desviación estándar. También puede filtrar los valores de NA utilizando <code>filter</code>.</p>
<p>2. Usando una tubería, asigne el promedio a una variable numérica <code>ref_avg</code>. Sugerencia: use el código similar al anterior y luego <code>pull</code>.</p>
<p>3. Ahora informe los valores mínimo y máximo para el mismo grupo.</p>
<p>4. Calcule el promedio y la desviación estándar para las mujeres, pero para cada grupo de edad por separado en lugar de una década seleccionada como en la pregunta 1. Tenga en cuenta que los grupos de edad se definen por <code>AgeDecade</code>. Sugerencia: en lugar de filtrar por edad y género, filtre por <code>Gender</code> y luego usar <code>group_by</code>.</p>
<p>5. Repita el ejercicio 4 para hombres.</p>
<p>6. De hecho, podemos combinar ambos resúmenes para los ejercicios 4 y 5 en una línea de código. Esto es porque <code>group_by</code> nos permite agrupar por más de una variable. Obtenga una gran tabla resumen usando <code>group_by(AgeDecade, Gender)</code>.</p>
<p>7. Para los hombres entre las edades de 40-49, compare la presión arterial sistólica a través de la raza como se informa en el <code>Race1</code> variable. Ordene la tabla resultante de la presión arterial sistólica promedio más baja a más alta.</p>
</div>
<div id="tibbles" class="section level2">
<h2><span class="header-section-number">6.10</span> Tibbles</h2>
<p>Los datos ordenados deben almacenarse en marcos de datos. Introdujimos el marco de datos en la Sección <a href="r-basics.html#data-frames">5.4.1</a> y he estado usando el <code>murders</code> marco de datos en todo el libro. En la sección <a href="tidyverse.html#group-by">6.7.3</a> presentamos el <code>group_by</code> función, que permite estratificar datos antes de calcular estadísticas resumidas. Pero, ¿dónde se almacena la información del grupo en el marco de datos?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(region)</code></pre></div>
<pre><code>## # A tibble: 51 x 6
## # Groups:   region [4]
##   state      abb   region population total  rate
##   &lt;chr&gt;      &lt;chr&gt; &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Alabama    AL    South     4779736   135  2.82
## 2 Alaska     AK    West       710231    19  2.68
## 3 Arizona    AZ    West      6392017   232  3.63
## 4 Arkansas   AR    South     2915918    93  3.19
## 5 California CA    West     37253956  1257  3.37
## # … with 46 more rows</code></pre>
<p>Tenga en cuenta que no hay columnas con esta información. Pero, si observa de cerca la salida anterior, verá la línea <code>A tibble</code> seguido por dimensiones. Podemos aprender la clase del objeto devuelto usando:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(region) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">class</span>()</code></pre></div>
<pre><code>## [1] &quot;grouped_df&quot; &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Los <code>tbl</code>, pronunciado tibble, es un tipo especial de marco de datos. Las funciones <code>group_by</code> y <code>summarize</code> siempre devuelve este tipo de marco de datos. los <code>group_by</code> la función devuelve un tipo especial de <code>tbl</code>, el <code>grouped_df</code>. Diremos más sobre esto más adelante. Por coherencia, los verbos de manipulación <strong>dplyr</strong> ( <code>select</code>, <code>filter</code>, <code>mutate</code> y <code>arrange</code>) preservar la clase de la entrada: si reciben un marco de datos regular, devuelven un marco de datos regular, mientras que si reciben un tibble, devuelven un tibble. Pero los tibbles son el formato preferido en el tidyverse y, como resultado, las funciones tidyverse que producen un marco de datos desde cero devuelven un tibble. Por ejemplo, en el capítulo <a href="importing-data.html#importing-data">2</a> veremos que las funciones tidyverse usadas para importar datos crean tibbles.</p>
<p>Los tibbles son muy similares a los marcos de datos. De hecho, puede pensar en ellos como una versión moderna de marcos de datos. Sin embargo, hay tres diferencias importantes que describiremos en el siguiente.</p>
<div id="tibbles-se-muestran-mejor" class="section level3">
<h3><span class="header-section-number">6.10.1</span> Tibbles se muestran mejor</h3>
<p>El método de impresión para tibbles es más legible que el de un marco de datos. Para ver esto, compare los resultados de escribir <code>murders</code> y la salida de asesinatos si lo convertimos en un tibble. Podemos hacer esto usando <code>as_tibble(murders)</code>. Si usa RStudio, la salida para un tibble se ajusta al tamaño de su ventana. Para ver esto, cambie el ancho de su consola R y observe cómo se muestran más/ menos columnas.</p>
</div>
<div id="los-subconjuntos-de-tibbles-son-tibbles" class="section level3">
<h3><span class="header-section-number">6.10.2</span> Los subconjuntos de tibbles son tibbles</h3>
<p>Si subconjuntos las columnas de un marco de datos, puede recuperar un objeto que no es un marco de datos, como un vector o escalar. Por ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(murders[,<span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>no es un marco de datos. Con tibbles esto no sucede:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="kw">as_tibble</span>(murders)[,<span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Esto es útil en tidyverse ya que las funciones requieren marcos de datos como entrada.</p>
<p>Con tibbles, si desea acceder al vector que define una columna y no recuperar un marco de datos, debe usar el descriptor de acceso <code>$</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="kw">as_tibble</span>(murders)<span class="op">$</span>population)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>Una característica relacionada es que tibbles le dará una advertencia si intenta acceder a una columna que no existe. Si escribimos accidentalmente <code>Population</code> en lugar de <code>population</code> esta:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders<span class="op">$</span>Population</code></pre></div>
<pre><code>## NULL</code></pre>
<p>devuelve un <code>NULL</code> sin advertencia, lo que puede dificultar la depuración. Por el contrario, si intentamos esto con un tibble, obtenemos una advertencia informativa:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as_tibble</span>(murders)<span class="op">$</span>Population</code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: &#39;Population&#39;.</code></pre>
<pre><code>## NULL</code></pre>
</div>
<div id="tibbles-puede-tener-entradas-complejas" class="section level3">
<h3><span class="header-section-number">6.10.3</span> Tibbles puede tener entradas complejas</h3>
<p>Si bien las columnas del marco de datos deben ser vectores de números, cadenas o valores lógicos, los tibbles pueden tener objetos más complejos, como listas o funciones. Además, podemos crear tibbles con funciones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">id =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">func =</span> <span class="kw">c</span>(mean, median, sd))</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##      id func  
##   &lt;dbl&gt; &lt;list&gt;
## 1     1 &lt;fn&gt;  
## 2     2 &lt;fn&gt;  
## 3     3 &lt;fn&gt;</code></pre>
</div>
<div id="tibbles-se-pueden-agrupar" class="section level3">
<h3><span class="header-section-number">6.10.4</span> Tibbles se pueden agrupar</h3>
<p>La función <code>group_by</code> devuelve un tipo especial de tibble: un tibble agrupado. Esta clase almacena información que le permite saber qué filas están en qué grupos. Las funciones tidyverse, en particular la <code>summarize</code> función, son conscientes de la información del grupo.</p>
</div>
<div id="crear-un-tibble-usando-tibble-en-lugar-de-data.frame" class="section level3">
<h3><span class="header-section-number">6.10.5</span> Crear un tibble usando <code>tibble</code> en lugar de <code>data.frame</code></h3>
<p>A veces es útil para nosotros crear nuestros propios marcos de datos. Para crear un marco de datos en formato tibble, puede hacerlo utilizando el <code>tibble</code> función.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grades &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Jean&quot;</span>, <span class="st">&quot;Yao&quot;</span>),
<span class="dt">exam_1 =</span> <span class="kw">c</span>(<span class="dv">95</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">85</span>),
<span class="dt">exam_2 =</span> <span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">90</span>))</code></pre></div>
<p>Tenga en cuenta que la base R (sin paquetes cargados) tiene una función con un nombre muy similar, <code>data.frame</code>, que se puede usar para crear un marco de datos regular en lugar de un tibble. Otra diferencia importante es que por defecto <code>data.frame</code> coacciona los caracteres en factores sin proporcionar una advertencia o mensaje:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grades &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Jean&quot;</span>, <span class="st">&quot;Yao&quot;</span>),
<span class="dt">exam_1 =</span> <span class="kw">c</span>(<span class="dv">95</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">85</span>),
<span class="dt">exam_2 =</span> <span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">90</span>))
<span class="kw">class</span>(grades<span class="op">$</span>names)</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<p>Para evitar esto, usamos el argumento bastante engorroso <code>stringsAsFactors</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grades &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Jean&quot;</span>, <span class="st">&quot;Yao&quot;</span>),
<span class="dt">exam_1 =</span> <span class="kw">c</span>(<span class="dv">95</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">85</span>),
<span class="dt">exam_2 =</span> <span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">90</span>),
<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">class</span>(grades<span class="op">$</span>names)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Para convertir un marco de datos normal en un tibble, puede usar el <code>as_tibble</code> función.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as_tibble</span>(grades) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">class</span>()</code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
</div>
</div>
<div id="el-operador-punto" class="section level2">
<h2><span class="header-section-number">6.11</span> El operador punto</h2>
<p>Una de las ventajas de utilizar la tubería. <code>%&gt;%</code> es que no tenemos que seguir nombrando nuevos objetos mientras manipulamos el marco de datos. Como recordatorio rápido, si queremos calcular la tasa de asesinatos promedio para los estados del sur, en lugar de escribir:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tab_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(murders, region <span class="op">==</span><span class="st"> &quot;South&quot;</span>)
tab_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mutate</span>(tab_<span class="dv">1</span>, <span class="dt">rate =</span> total<span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span>)
rates &lt;-<span class="st"> </span>tab_<span class="dv">2</span><span class="op">$</span>rate
<span class="kw">median</span>(rates)</code></pre></div>
<pre><code>## [1] 3.4</code></pre>
<p>Podemos evitar definir nuevos objetos intermedios escribiendo en su lugar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(murders, region <span class="op">==</span><span class="st"> &quot;South&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">mutate</span>(<span class="dt">rate =</span> total<span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span>) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">median =</span> <span class="kw">median</span>(rate)) <span class="op">%&gt;%</span>
<span class="kw">pull</span>(median)</code></pre></div>
<pre><code>## [1] 3.4</code></pre>
<p>Podemos hacer esto porque cada una de estas funciones toma un marco de datos como primer argumento. Pero, ¿qué pasa si queremos acceder a un componente del marco de datos? Por ejemplo, ¿qué pasa si el <code>pull</code> la función no estaba disponible y queríamos acceder <code>tab_2$rate</code>? ¿Qué nombre de marco de datos usaríamos? La respuesta es el operador de puntos.</p>
<p>Por ejemplo, para acceder al vector de velocidad sin el <code>pull</code> función que podríamos usar</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rates &lt;-<span class="kw">filter</span>(murders, region <span class="op">==</span><span class="st"> &quot;South&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">mutate</span>(<span class="dt">rate =</span> total<span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span>) <span class="op">%&gt;%</span>
.<span class="op">$</span>rate
<span class="kw">median</span>(rates)</code></pre></div>
<pre><code>## [1] 3.4</code></pre>
<p>En la siguiente sección, veremos otras instancias en las que usar el <code>.</code> es útil.</p>
</div>
<div id="do" class="section level2">
<h2><span class="header-section-number">6.12</span> <code>do</code></h2>
<p>Las funciones tidyverse saben interpretar tibbles agrupados. Además, para facilitar la secuencia de comandos a través de la tubería <code>%&gt;%</code>, las funciones tidyverse devuelven constantemente marcos de datos, ya que esto asegura que la salida de una función sea aceptada como la entrada de otra. Pero la mayoría de las funciones R no reconocen los tibbles agrupados ni devuelven marcos de datos. los <code>quantile</code> la función es un ejemplo que describimos en la Sección <a href="tidyverse.html#summarize">6.7.1</a>. Los <code>do</code> la función sirve como puente entre las funciones R, como <code>quantile</code> y el tidyverse. los <code>do</code> la función comprende tibbles agrupados y siempre devuelve un marco de datos.</p>
<p>En la sección <a href="tidyverse.html#summarize">6.7.1</a>, notamos que si intentamos usar <code>quantile</code> para obtener el mínimo, la mediana y el máximo en una llamada, recibiremos un error: <code>Error: expecting result of length one, got : 2</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(heights)
heights <span class="op">%&gt;%</span>
<span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;Female&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">range =</span> <span class="kw">quantile</span>(height, <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)))</code></pre></div>
<p>Podemos usar el <code>do</code> función para arreglar esto.</p>
<p>Primero tenemos que escribir una función que se ajuste al enfoque tidyverse: es decir, recibe un marco de datos y devuelve un marco de datos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_summary &lt;-<span class="st"> </span><span class="cf">function</span>(dat){
x &lt;-<span class="st"> </span><span class="kw">quantile</span>(dat<span class="op">$</span>height, <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))
<span class="kw">tibble</span>(<span class="dt">min =</span> x[<span class="dv">1</span>], <span class="dt">median =</span> x[<span class="dv">2</span>], <span class="dt">max =</span> x[<span class="dv">3</span>])
}</code></pre></div>
<p>Ahora podemos aplicar la función al conjunto de datos de alturas para obtener los resúmenes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span>
<span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span>
my_summary</code></pre></div>
<pre><code>## # A tibble: 1 x 3
##     min median   max
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1    50   68.5  82.7</code></pre>
<p>Pero esto no es lo que queremos. Queremos un resumen para cada sexo y el código devolvió solo un resumen. Esto es porque <code>my_summary</code> no es parte del tidyverse y no sabe cómo manejar los tibbles agrupados. <code>do</code> hace esta conexión:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span>
<span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span>
<span class="kw">do</span>(<span class="kw">my_summary</span>(.))</code></pre></div>
<pre><code>## # A tibble: 2 x 4
## # Groups:   sex [2]
##   sex      min median   max
##   &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 Female    51   65.0  79  
## 2 Male      50   69    82.7</code></pre>
<p>Tenga en cuenta que aquí necesitamos usar el operador de punto. El tibble creado por <code>group_by</code> se canaliza a <code>do</code>. Dentro de la llamada a <code>do</code>, el nombre de este tibble es <code>.</code> y queremos enviarlo a <code>my_summary</code>. Si no usa el punto, entonces <code>my_summary</code> no tiene ningún argumento y devuelve un error que nos dice que <code>argument &quot;dat&quot;</code> está perdido. Puede ver el error escribiendo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span>
<span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span>
<span class="kw">do</span>(<span class="kw">my_summary</span>())</code></pre></div>
<p>Si no usa el paréntesis, entonces la función no se ejecuta y en su lugar <code>do</code> intenta devolver la función. Esto da un error porque <code>do</code> siempre debe devolver un marco de datos. Puede ver el error escribiendo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights <span class="op">%&gt;%</span>
<span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span>
<span class="kw">do</span>(my_summary)</code></pre></div>
</div>
<div id="el-paquete-purrr" class="section level2">
<h2><span class="header-section-number">6.13</span> El paquete <strong>purrr</strong></h2>
<p>En la sección <a href="conceptos-basicos-de-programacion.html#vectorization">4.5</a> aprendimos sobre el <code>sapply</code> función, que nos permitió aplicar la misma función a cada elemento de un vector. Construimos una función y utilizamos <code>sapply</code> para calcular la suma de la primera <code>n</code> enteros para varios valores de <code>n</code> me gusta esto:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">compute_s_n &lt;-<span class="st"> </span><span class="cf">function</span>(n){
x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n
<span class="kw">sum</span>(x)
}
n &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">25</span>
s_n &lt;-<span class="st"> </span><span class="kw">sapply</span>(n, compute_s_n)</code></pre></div>
<p>Este tipo de operación, que aplica la misma función o procedimiento a elementos de un objeto, es bastante común en el análisis de datos. El paquete <strong>purrr</strong> incluye funciones similares a <code>sapply</code> pero eso interactúa mejor con otras funciones tidyverse. La principal ventaja es que podemos controlar mejor el tipo de funciones de salida. A diferencia de, <code>sapply</code> puede devolver varios tipos de objetos diferentes; por ejemplo, podríamos esperar un resultado numérico de una línea de código, pero <code>sapply</code> podría convertir nuestro resultado en carácter en algunas circunstancias. Las funciones <strong>purrr</strong> nunca harán esto: devolverán objetos de un tipo específico o devolverán un error si esto no es posible.</p>
<p>La primera función <strong>purrr</strong> que aprenderemos es <code>map</code>, que funciona muy similar a <code>sapply</code> pero siempre, sin excepción, devuelve una lista:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(purrr)
s_n &lt;-<span class="st"> </span><span class="kw">map</span>(n, compute_s_n)
<span class="kw">class</span>(s_n)</code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>Si queremos un vector numérico, podemos usar <code>map_dbl</code> que siempre devuelve un vector de valores numéricos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s_n &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(n, compute_s_n)
<span class="kw">class</span>(s_n)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>Esto produce los mismos resultados que el <code>sapply</code> llamada que se muestra arriba.</p>
<p>Una función <strong>purrr</strong> particularmente útil para interactuar con el resto del tidyverse es <code>map_df</code>, que siempre devuelve un marco de datos tibble. Sin embargo, la función que se llama debe devolver un vector o una lista con nombres. Por esta razón, el siguiente código daría como resultado un <code>Argument 1 must have names</code> error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s_n &lt;-<span class="st"> </span><span class="kw">map_df</span>(n, compute_s_n)</code></pre></div>
<p>Necesitamos cambiar la función para que esto funcione:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">compute_s_n &lt;-<span class="st"> </span><span class="cf">function</span>(n){
x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n
<span class="kw">tibble</span>(<span class="dt">sum =</span> <span class="kw">sum</span>(x))
}
s_n &lt;-<span class="st"> </span><span class="kw">map_df</span>(n, compute_s_n)</code></pre></div>
<p>El paquete <strong>purrr</strong> proporciona mucha más funcionalidad no cubierta aquí. Para obtener más detalles, puede consultar [este recurso en línea] (<a href="https://jennybc.github.io/purrr-tutorial/" class="uri">https://jennybc.github.io/purrr-tutorial/</a>).</p>
</div>
<div id="tidyverse-condicionales" class="section level2">
<h2><span class="header-section-number">6.14</span> Tidyverse condicionales</h2>
<p>Un análisis de datos típico a menudo implicará una o más operaciones condicionales. En la sección <a href="conceptos-basicos-de-programacion.html#conditionals">4.1</a> describimos el <code>ifelse</code> función, que utilizaremos ampliamente en este libro. En esta sección presentamos dos funciones <strong>dplyr</strong> que proporcionan una funcionalidad adicional para realizar operaciones condicionales.</p>
<div id="case_when" class="section level3">
<h3><span class="header-section-number">6.14.1</span> <code>case_when</code></h3>
<p>Los <code>case_when</code> la función es útil para vectorizar declaraciones condicionales. Esto es similar a <code>ifelse</code> pero puede generar cualquier cantidad de valores, en lugar de solo <code>TRUE</code> o <code>FALSE</code>. Aquí hay un ejemplo que divide los números en negativo, positivo y 0:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)
<span class="kw">case_when</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Negative&quot;</span>, x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Positive&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Zero&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;Negative&quot; &quot;Negative&quot; &quot;Zero&quot;     &quot;Positive&quot; &quot;Positive&quot;</code></pre>
<p>Un uso común de esta función es definir variables categóricas basadas en variables existentes. Por ejemplo, supongamos que queremos comparar las tasas de homicidios en tres grupos de estados: <em>Nueva Inglaterra</em>, <em>West Coast</em>, <em>South_y_other</em>. Para cada estado, debemos preguntar si está en Nueva Inglaterra, si no es así, preguntamos si está en la costa oeste, si no, preguntamos si está en el sur, y si no, asignamos otros. Así es como usamos <code>case_when</code> para hacer esto:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">murders <span class="op">%&gt;%</span>
<span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">case_when</span>(
abb <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ME&quot;</span>, <span class="st">&quot;NH&quot;</span>, <span class="st">&quot;VT&quot;</span>, <span class="st">&quot;MA&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;CT&quot;</span>) <span class="op">~</span><span class="st"> &quot;New England&quot;</span>,
abb <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;OR&quot;</span>, <span class="st">&quot;CA&quot;</span>) <span class="op">~</span><span class="st"> &quot;West Coast&quot;</span>,
region <span class="op">==</span><span class="st"> &quot;South&quot;</span> <span class="op">~</span><span class="st"> &quot;South&quot;</span>,
<span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Other&quot;</span>)) <span class="op">%&gt;%</span>
<span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="kw">summarize</span>(<span class="dt">rate =</span> <span class="kw">sum</span>(total)<span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(population) <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   group        rate
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 New England  1.72
## 2 Other        2.71
## 3 South        3.63
## 4 West Coast   2.90</code></pre>
</div>
<div id="between" class="section level3">
<h3><span class="header-section-number">6.14.2</span> <code>between</code></h3>
<p>Una operación común en el análisis de datos es determinar si un valor cae dentro de un intervalo. Podemos verificar esto usando condicionales. Por ejemplo para verificar si los elementos de un vector <code>x</code> están entre <code>a</code> y <code>b</code> podemos escribir</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x <span class="op">&gt;=</span><span class="st"> </span>a <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;=</span><span class="st"> </span>b</code></pre></div>
<p>Sin embargo, esto puede volverse engorroso, especialmente dentro del enfoque tidyverse. los <code>between</code> la función realiza la misma operación.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">between</span>(x, a, b)</code></pre></div>
</div>
</div>
<div id="ejercicios-14" class="section level2">
<h2><span class="header-section-number">6.15</span> Ejercicios</h2>
<p>1. Carga el <code>murders</code> conjunto de datos ¿Cual de los siguientes es verdadero?</p>
<ol style="list-style-type: lower-alpha">
<li><code>murders</code> está en formato ordenado y se almacena en un tibble. si. <code>murders</code> está en formato ordenado y se almacena en un marco de datos.</li>
<li><code>murders</code> no está en formato ordenado y se almacena en un tibble. re. <code>murders</code> no está en formato ordenado y se almacena en un marco de datos.</li>
</ol>
<p>2. Utilizar <code>as_tibble</code> para convertir el <code>murders</code> tabla de datos en un tibble y guárdelo en un objeto llamado <code>murders_tibble</code>.</p>
<p>3. Utilizar el <code>group_by</code> función para convertir asesinatos en un tibble que se agrupa por región.</p>
<p>4. Escriba el código tidyverse que sea equivalente a este código:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">mean</span>(<span class="kw">log</span>(murders<span class="op">$</span>population)))</code></pre></div>
<p>Escríbalo usando la tubería para que cada función se llame sin argumentos. Use el operador de puntos para acceder a la población. Sugerencia: el código debe comenzar con <code>murders %&gt;%</code>.</p>
<p>5. Utilizar el <code>map_df</code> para crear un marco de datos con tres columnas llamadas <code>n</code>, <code>s_n</code> y <code>s_n_2</code>. La primera columna debe contener los números del 1 al 100. La segunda y la tercera columna deben contener la suma del 1 al 100 <span class="math inline">\(n\)</span> con <span class="math inline">\(n\)</span> el número de fila.</p>

</div>
</div>


















            </section>

          </div>
        </div>
      </div>
<a href="r-basics.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
